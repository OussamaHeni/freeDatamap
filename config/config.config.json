{
	"$schema": "http://www.freedatamap.com/jsonConfigSchema/schema#",
    "config": {
        "root": null,
        "multicolorBrothers": false,
        "styles": [{
            "name": "root",
            "level": 0,
            "arrow": true,
            "arc": false,
            "rNod": 10,
            "link": 130,
            "color": "#1f77b4",
            "attrPaneCol": "#aec7e8",
            "icon": "../../config/images/config/config_root.png",
            "icon.dm_props": {
                "width": 180,
                "height": 180,
                "scaleFactor": 4.5,
                "panelMaxHeight": 180,
                "visible": true,
                "textX": 0,
                "type": "image"
            },
            "backgroundImage": "../../config/images/config/config.jpg",
            "backgroundImage.dm_props": {
                "name": "backgroundImage",
                "visible": true,
                "label": "backgroundImage",
                "type": "image",
                "edit": false,
                "imageName": "../../config/images/config/config.jpg",
                "width": 1200,
                "height": 850,
                "scaleFactor": 1
            }
        }, {
            "name": "level 1",
            "level": 1,
            "arrow": true,
            "arc": false,
            "rNod": 10,
            "link": 130,
            "color": "#1f77b4",
            "attrPaneCol": "#aec7e8",
            "icon": "../../config/images/config/config.png",
            "icon.dm_props": {
                "width": 178,
                "height": 180,
                "scaleFactor": 4.5,
                "panelMaxHeight": 180,
                "visible": true,
                "textX": 0,
                "type": "image"
            }
        }, {
            "name": "level 2",
            "level": 2,
            "arrow": true,
            "arc": false,
            "rNod": 9,
            "link": 130,
            "color": "#ff7f0e",
            "attrPaneCol": "#ffbb78"
        }, {
            "name": "level 3",
            "level": 3,
            "arrow": true,
            "arc": false,
            "rNod": 9,
            "link": 130,
            "color": "#2ca02c",
            "attrPaneCol": "#98df8a"
        }, {
            "name": "level 4",
            "level": 4,
            "arrow": true,
            "arc": false,
            "rNod": 9,
            "link": 130,
            "color": "#d62728",
            "attrPaneCol": "#ff9896"
        }, {
            "name": "level 5",
            "level": 5,
            "arrow": true,
            "arc": false,
            "rNod": 8,
            "link": 130,
            "color": "#9467bd",
            "attrPaneCol": "#c5b0d5"
        }, {
            "name": "level 6",
            "level": 6,
            "arrow": true,
            "arc": false,
            "rNod": 8,
            "link": 130,
            "color": "#e377c2",
            "attrPaneCol": "#f7b6d2"
        }, {
            "name": "level 7",
            "level": 7,
            "arrow": true,
            "arc": false,
            "rNod": 7,
            "link": 130,
            "color": "#bcbd22",
            "attrPaneCol": "#dbdb8d"
        }, {
            "name": "level 8",
            "level": 8,
            "arrow": true,
            "arc": false,
            "rNod": 7,
            "link": 130,
            "color": "#17becf",
            "attrPaneCol": "#9edae5"
        }, {
            "name": "level 9",
            "level": 9,
            "arrow": true,
            "arc": false,
            "rNod": 6,
            "link": 130,
            "color": "#6b6ecf",
            "attrPaneCol": "#9c9ede"
        }, {
            "name": "level 10",
            "level": 10,
            "arrow": true,
            "arc": false,
            "rNod": 6,
            "link": 130,
            "color": "#1f77b4",
            "attrPaneCol": "#aec7e8"
        }, {
            "name": "level 11",
            "level": 11,
            "arrow": true,
            "arc": false,
            "rNod": 5,
            "link": 130,
            "color": "#ff7f0e",
            "attrPaneCol": "#ffbb78"
        }, {
            "name": "level 12",
            "level": 12,
            "arrow": true,
            "arc": false,
            "rNod": 5,
            "link": 130,
            "color": "#2ca02c",
            "attrPaneCol": "#98df8a"
        }, {
            "name": "level 13",
            "level": 13,
            "arrow": true,
            "arc": false,
            "rNod": 5,
            "link": 130,
            "color": "#d62728",
            "attrPaneCol": "#ff9896"
        }, {
            "name": "level 14",
            "level": 14,
            "arrow": true,
            "arc": false,
            "rNod": 5,
            "link": 130,
            "color": "#9467bd",
            "attrPaneCol": "#c5b0d5"
        }, {
            "name": "level 15",
            "level": 15,
            "arrow": true,
            "arc": false,
            "rNod": 4,
            "link": 130,
            "color": "#e377c2",
            "attrPaneCol": "#f7b6d2"
        }, {
            "name": "level 16",
            "level": 16,
            "arrow": true,
            "arc": false,
            "rNod": 4,
            "link": 130,
            "color": "#bcbd22",
            "attrPaneCol": "#dbdb8d"
        }, {
            "name": "level 17",
            "level": 17,
            "arrow": true,
            "arc": false,
            "rNod": 4,
            "link": 130,
            "color": "#17becf",
            "attrPaneCol": "#9edae5"
        }, {
            "name": "level 18",
            "level": 18,
            "arrow": true,
            "arc": false,
            "rNod": 4,
            "link": 130,
            "color": "#6b6ecf",
            "attrPaneCol": "#9c9ede"
        }, {
            "name": "leaf",
            "level": 19,
            "arrow": false,
            "arc": true,
            "rNod": 3,
            "link": 90,
            "color": "#c7c7c7",
            "attrPaneCol": "#c7c7c7",
            "txtCol": "#7f7f7f"
        }],
        "center": null,
        "depth": 2,
        "setColumns2node": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null],
        "aggregate": null,
        "sortDescendant": false,
        "displayProps": [{
            "name": "root",
            "children": [
                {
                    "name": "noLeafInReport",
                    "label": "No leaf in report",
                    "type": "boolean"
                },
                {
                    "name": "sortDescendant",
                    "label": "Sort descendant",
                    "type": "boolean"
                }
            ],
            "visible": true,
            "edit": true
        }, {
            "name": "level 1",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 2",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 3",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 4",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 5",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 6",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 7",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 8",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 9",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 10",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 11",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 12",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 13",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 14",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 15",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 16",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 17",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "level 18",
            "children": [],
            "visible": true,
            "edit": true
        }, {
            "name": "leaf",
            "children": [],
            "visible": true,
            "edit": true
        }],
        "specifics": [
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root",
            "rawNode": {
                "setEmptyDefaults": "
node.rawNode.depth = node.rawNode.depth || 2 ;
//node.rawNode.sort = node.rawNode.sort || '' ;
//node.rawNode.root = node.rawNode.root || '' ;
//node.rawNode.center = node.rawNode.center || '' ;
node.rawNode.maxNbOfColumns2tree = node.rawNode.maxNbOfColumns2tree || 10 ;
//node.rawNode.multicolorBrothers = node.rawNode.multicolorBrothers || false ;
if((node.rawNode.csvSepIsSemicolon !== false) && (node.rawNode.csvSepIsSemicolon !== 'false')) {
    node.rawNode.csvSepIsSemicolon = true ;
}
if((node.rawNode.displayTransversalConnections !== false) && (node.rawNode.displayTransversalConnections !== 'false')) {
    node.rawNode.displayTransversalConnections = true ;
}
if((node.rawNode.displayArrowsOfTransversalConnections !== false) && (node.rawNode.displayArrowsOfTransversalConnections !== 'false')) {
    node.rawNode.displayArrowsOfTransversalConnections = true ;
}
'#dm_STOP_AND_REDRAW_ATTRIBUTES_PANEL#1' ;
",
                "setEmptyDefaults.dm_props": {
                    "order": 0,
                    "type": "execute"
                },
                "icon": "../../config/images/config/config_root.png",
                "icon.dm_props": {
                    "order": 1,
                    "type": "image"
                },
                "depth.dm_props": {
                    "order": 2,
                    "visible": true,
                    "edit": false,
                    "type": "dropdown",
                    "name": "depth",
                    "dropdownList": "[1, 2, 3, 4]",
                    "displayEvenIfUndefined": true
                },
                "sort.dm_props": {
                    "order": 3,
                    "visible": true,
                    "edit": false,
                    "type": "dropdown",
                    "name": "sort",
                    "dropdownList": "['random : no sort'].concat(dm_Tools.feedPossibleProperties(node)) ;",
                    "displayEvenIfUndefined": true
                },
                "sortDescendant.dm_props": {
                    "order": 4,
                    "type": "boolean",
                    "displayEvenIfUndefined": true
                },
                "root.dm_props": {
                    "order": 5,
                    "displayEvenIfUndefined": true
                },
                "center.dm_props": {
                    "order": 6,
                    "displayEvenIfUndefined": true
                },
                "csvSepIsSemicolon.dm_props": {
                    "order": 7,
                    "type": "boolean"
                },
                "displayTransversalConnections.dm_props": {
                    "order": 8,
                    "type": "boolean"
                },
                "displayArrowsOfTransversalConnections.dm_props": {
                    "order": 9,
                    "type": "boolean"
                },
                "noLeafInReport.dm_props": {
                    "order": 10,
                    "type": "boolean",
                    "displayEvenIfUndefined": true
                },
                "maxDepthForExport.dm_props": {
                    "order": 11,
                    "displayEvenIfUndefined": true
                },
                "isLngFirst.dm_props": {
                    "order": 12,
                    "type": "boolean",
                    "displayEvenIfUndefined": true
                },
                "maxNbOfColumns2tree.dm_props": {
                    "order": 13,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "label": "max number of columns to tree",
                    "dropdownList": "[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]",
                    "displayEvenIfUndefined": true
                },
                "multicolorBrothers.dm_props": {
                    "order": 14,
                    "type": "boolean",
                    "displayEvenIfUndefined": true
                },
                "reloadBtn": "Reload data file",
                "reloadBtn.dm_props": {
                    "order": -1,
                    "name": "reloadBtn",
                    "label": "Reload data file",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/load all.png",
                    "imageName": "../../images/load all.png",
                    "class": "btn-info",
                    "content.exec" : "dm_Datamap.admin(true, true);"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|columns",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|columns",
            "rawNode": {
                "icon": "../../config/images/config/columns.png",
                "icon.dm_props": {
                    "edit": false,
                    "width": 121,
                    "height": 66,
                    "scaleFactor": 6,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "textX": 3,
                    "type": "image",
                    "name": "icon",
                    "imageName": "../../config/images/config/columns.png",
                    "tintedSrc": "data:image/png;base64,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",
                    "level": 2,
                    "label": "icon",
                    "source": "user"
                },
                "description": "
<div class=\"dm_normal\">First column name is used to create the first level of the tree, second column name will help freeDatamap to create the second level of the graph, etc.</div>
",
                "description.dm_props": {
                    "name": "description",
                    "label": "description",
                    "visible": true,
                    "edit": false,
                    "type": "rich text",
                    "source": "user",
                    "level": 2
                },
                "columnNameDropdown": null,
                "columnNameDropdown.dm_props": {
                    "label": "Column name",
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "
var getColumnNames = function(node) {
    var output = null ;
    var alreadyFound = function(columnName, columnNameIdx) {
        if(node && node.children && (node.children.length > 0)) {
            var alreadyExistingCol ;
            var test = function(elt) {
                //console.log('' + elt.name + ' == ' + columnName + ' ? ' + (elt.name == columnName)) ;
                //console.log('' + elt.name + ' == ' + columnNameIdx + ' ? ' + (elt.name == ('' + columnNameIdx))) ;
                if((elt.name == columnName) || (elt.name == ('' + columnNameIdx))) {
                    return true ;
                }
            }
            for(var i=0; i<node.children.length; i++) {
                alreadyExistingCol = node.children[i] ;
                if(alreadyExistingCol.children) {
                    var leafJ ;
                    for(var j=0; j<alreadyExistingCol.children.length; j++) {
                        leafJ = alreadyExistingCol.children[j] ;
                        if(test(leafJ)) return true ;
                    }
                } else {
                    if(test(alreadyExistingCol)) return true ;
                }
            }
        }
    }
    if(node && node.parent && node.parent.children) {
        var colNamesNode = dm_Tools.getChild(node.parent, 'columnNames') ;
        if(colNamesNode && colNamesNode.children && (colNamesNode.children.length > 0)) {
            output = [] ;
            var child ;
            for(var i=0; i<colNamesNode.children.length; i++) {
                child = colNamesNode.children[i] ;
                if(child && child.name && !alreadyFound(child.name, i)) {
                    output.push(child.name) ;
                }
            }
        }
    }
    return output ;
} ;
getColumnNames(node) ;
                    ",
                    "name": "columnNameDropdown",
                    "level": 2,
                    "label": "columnNameDropdown",
                    "source": "user",
                    "placeHolder": "no spare column to add..."
                },
                "addColumnBtn": "Add column",
                "addColumnBtn.dm_props": {
                    "name": "addColumnBtn",
                    "label": "Add column",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/plus.png",
                    "imageName": "../../images/plus.png",
                    "class": "btn-info",
                    "content.exec" : "
var doit = function(node) {
    var columnName = null ;
    var newNode ;
    if(node && node.rawNode) columnName = node.rawNode.columnNameDropdown ;
    if(columnName) {
        newNode = dm_Datamap.createNode(node, columnName) ;
        var idx = node.children.length - 1 ;
        if(node.children && (node.children.length > 1) && (typeof(node.children[node.children.length - 2].name) == 'undefined')) {
            node.children.splice(node.children.length - 1, 1) ;
            node.children.splice(node.children.length - 1, 0, newNode) ;
            idx = node.children.length - 2 ;
        }
        if(!newNode.rawNode) newNode.rawNode = {} ;
        newNode.rawNode['array index'] = idx ;
        newNode.rawNode['columnIndex'] = dm_Tools.getChildIndex(dm_Tools.getChild(node.parent, 'columnNames'), columnName) ;
    }
} ;
doit(node) ;
dm_Tools.alignConfigTreeToColumnsNumber(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "addLeafBtn": "Add leaf",
                "addLeafBtn.dm_props": {
                    "name": "addLeafBtn",
                    "label": "Add leaf",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/plus.png",
                    "imageName": "../../images/plus.png",
                    "class": "btn-info",
                    "content.exec" : "
var doit = function(node) {
    var columnName = null ;
    var newNode ;
    if(node && node.rawNode) columnName = node.rawNode.columnNameDropdown ;
    if(columnName) {
        var leafParent ;
        if(node.children && (node.children.length > 0)) {
            leafParent = node.children[node.children.length - 1] ;
            if(leafParent.name) leafParent = null ;
        }
        if(!leafParent) {
            leafParent = dm_Datamap.createNode(node, '') ;
            if(!leafParent.rawNode) leafParent.rawNode = {} ;
            leafParent.rawNode['array index'] = node.children.length - 1 ;
            delete leafParent.name ;
        }
        leafNode = dm_Datamap.createNode(leafParent, columnName) ;
        if(!leafNode.rawNode) leafNode.rawNode = {} ;
        leafNode.rawNode['array index'] = leafParent.children.length - 1 ;
        leafNode.rawNode['columnIndex'] = dm_Tools.getChildIndex(dm_Tools.getChild(node.parent, 'columnNames'), columnName) ;
    }
} ;
doit(node) ;
dm_Tools.alignConfigTreeToColumnsNumber(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "description2": "
<div class=\"dm_normal\">Order children in the map according to your needs and then hit the following button.</div>
",
                "description2.dm_props": {
                    "name": "description",
                    "label": "description",
                    "visible": true,
                    "edit": false,
                    "type": "rich text",
                    "source": "user",
                    "level": 2
                },
                "orderChildrenBtn": "Order columns",
                "orderChildrenBtn.dm_props": {
                    "name": "orderChildrenBtn",
                    "label": "Order columns",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/tree.png",
                    "imageName": "../../images/tree.png",
                    "class": "btn-success",
                    "content.exec" : "
dm_Tools.sortChildrenByPos(node);
"
                },
                "reloadBtn": "Reload data file",
                "reloadBtn.dm_props": {
                    "name": "reloadBtn",
                    "label": "Reload data file",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/load all.png",
                    "imageName": "../../images/load all.png",
                    "class": "btn-info",
                    "content.exec" : "dm_Datamap.admin(true, true);"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|columns|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|columns|*",
            "rawNode": {
                "deleteBtn": "Delete",
                "deleteBtn.dm_props": {
                    "name": "deleteBtn",
                    "label": "Delete",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/delete.png",
                    "imageName": "../../images/delete.png",
                    "class": "btn-danger",
                    "content.exec" : "
var parent = node.parent ;
dm_Datamap.removeNode() ;
dm_Tools.alignChildrenArrayIndex(parent) ;
dm_Tools.alignConfigTreeToColumnsNumber(parent) ;
"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|columns|*|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|columns|*|*",
            "rawNode": {
                "deleteBtn": "Delete",
                "deleteBtn.dm_props": {
                    "name": "deleteBtn",
                    "label": "Delete",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/delete.png",
                    "imageName": "../../images/delete.png",
                    "class": "btn-danger",
                    "content.exec" : "
var parent = node.parent ;
dm_Datamap.removeNode() ;
if(parent.children.length == 0) {
    dm_Datamap.removeNode(parent) ;
}
dm_Tools.alignChildrenArrayIndex(parent) ;
dm_Tools.alignConfigTreeToColumnsNumber(parent) ;
"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|aggregate",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|aggregate",
            "rawNode": {
                "icon": "../../config/images/config/aggregate.png",
                "icon.dm_props": {
                    "width": 243,
                    "height": 180,
                    "scaleFactor": 5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                },
                "newAggregEltName": "",
                "newAggregEltName.dm_props": {
                    "edit": true,
                    "label": "New aggregated attribute name "
                },
                "addAggregationBtn": "Add new aggregated attribute",
                "addAggregationBtn.dm_props": {
                    "name": "addAggregationBtn",
                    "label": "Add new aggregated attribute",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/plus.png",
                    "imageName": "../../images/plus.png",
                    "class": "btn-info",
                    "content.exec" : "
// get latest entered value even if return key was not pressed
var uiId = dm_Attributes.getId('attribute_text_', {'name': 'newAggregEltName'}, node) ;
node.rawNode.newAggregEltName = document.getElementById(uiId).value ;

if(node.rawNode.newAggregEltName) {
    var child = dm_Tools.getChild(node, node.rawNode.newAggregEltName) ;
    if(!child) {
        child = dm_Datamap.createNode(node, node.rawNode.newAggregEltName) ;        
    }
    if(!child.rawNode) child.rawNode = {} ;
    if(child.rawNode.execAfterChildrenVisit == null) child.rawNode.execAfterChildrenVisit = true ;
    if(child.rawNode.funcDropdown == null) child.rawNode.funcDropdown = 'sum property' ;
    if(child.rawNode.propertyName == null) child.rawNode.propertyName = '' ;
    if(child.rawNode.value == null) child.rawNode.value = '' ;
    dm_Datamap.focusNode(child) ;
    dm_Datamap.refreshGraph(child);
}
"
                },
                "predefinedAggregateFunctions": {
                    "count leaves" : 
"var output = 1 ;
if(node.children) {
    var i = node.children.length - 1 ;
    output = 0 ;
    for(; i>=0; i--) {
        output += node.children[i].rawNode[propName] ;
    }
}
return output ;",
                    "sum property" :
"var output  ;
if(!#replaceMeBy_onlyLeaves# || !node.children) {
    output = node.rawNode['#replaceMeBy_propertyName#'] ;
}
if(node.children) {
    for(var i=0; i<node.children.length; i++) {
        if(!output) output = 0 ;
        output += parseFloat(node.children[i].rawNode[propName] || 0) ;
    }
}
return output ;",
                    "conditional count" :
"var output = 0 ;
var conditionalResult = eval('#replaceMeBy_condition#') ;
if(conditionalResult) {
    output = 1 ;
}
if(node.children) {
    var i = node.children.length - 1 ;
    for(; i>=0; i--) {
        output += node.children[i].rawNode[propName] ;
    }
}
return output ;",
                    "divide" :
"var divider = parseFloat(node.rawNode['#replaceMeBy_propertyDivider#'] || 1) ;
var propValue = parseFloat(node.rawNode['#replaceMeBy_propertyName#'] || 0) ;
return (propValue / divider) ;"
                },
                "predefinedAggregateFunctions.dm_props": {
                    "visible": false,
                    "edit": false
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|aggregate|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|aggregate|*",
            "rawNode": {
                "array index.dm_props": {
                    "visible": false,
                    "edit": false
                },
                "toExecute.dm_props": {
                    "visible": false,
                    "edit": false
                },
                "execAfterChildrenVisit.dm_props": {
                    "type": "boolean",
                    "order": 0
                },
                "funcDropdown.dm_props": {
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "order": 1,
                    "dropdownList": "
['count leaves',
'sum property',
'conditional count',
'divide']
                    ",
                    "name": "funcDropdown",
                    "label": "function",
                    "onChange": "
// reset aggregation value code
node.rawNode.value = '' ;

var found = false ;

if(!found) {
    if(node.rawNode.funcDropdown == 'sum property') {
        found = true ;
        node.rawNode.propertyName = '' ;
        node.rawNode.onlyLeaves = true ;
        node.rawNode['onlyLeaves.dm_props'] = {
            'edit': 'true',
            'type': 'boolean',
            'order': 3
        } ;
    } else {
        delete node.rawNode.propertyName ;
        delete node.rawNode.onlyLeaves ;
    }
}

if(!found) {
    if(node.rawNode.funcDropdown == 'conditional count') {
        found = true ;
        node.rawNode.condition = '' ;
        node.rawNode['condition.dm_props'] = {
            'edit': 'true',
            'type': 'javascript',
            'order': 2
        } ;
    } else {
        delete node.rawNode.condition ;
    }
}

if(!found) {
    if(node.rawNode.funcDropdown == 'divide') {
        found = true ;
        node.rawNode.propertyName = '' ;
        node.rawNode.propertyDivider = '' ;
    } else {
        delete node.rawNode.propertyName ;
        delete node.rawNode.propertyDivider ;
    }
}

dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node) ;
                    "
                },
                "propertyName.dm_props": {
                    "order": 2,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "dm_Tools.feedPossibleProperties(node) ;",
                    "name": "propertyName",
                    "label": "property name",
                    "placeHolder": "no property to add..."
                },
                "onlyLeaves.dm_props": {
                    "order": 3,
                    "type": "boolean",
                    "visible": true,
                    "edit": true,
                    "label": "only leaves"
                },
                "propertyDivider.dm_props": {
                    "order": 4,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "dm_Tools.feedPossibleProperties(node) ;",
                    "name": "propertyDivider",
                    "label": "property divider",
                    "placeHolder": "no property to add..."
                },
                "setFuncBtn": "Set aggregate function",
                "setFuncBtn.dm_props": {
                    "name": "setFuncBtn",
                    "label": "Set chosen aggregate function",
                    "visible": true,
                    "edit": false,
                    "order": 100,
                    "type": "action",
                    "image": "../../images/refresh.png",
                    "imageName": "../../images/refresh.png",
                    "class": "btn-info",
                    "content.exec" : "
node.rawNode.value = node.parent.rawNode.predefinedAggregateFunctions[node.rawNode.funcDropdown] ;
node.rawNode.value = dm_Tools.replaceByProperties(node, node.rawNode.value) ;
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node) ;
"
                },
                "br": "<br/>",
                "br.dm_props": {
                    "type": "rich text",
                    "edit": false,
                    "order": 101
                },
                "value.dm_props": {
                    "type": "javascript",
                    "order": -1
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|columnNames",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|columnNames",
            "rawNode": {
                "icon": "../../config/images/config/columnNames.png",
                "icon.dm_props": {
                    "width": 146,
                    "height": 102,
                    "scaleFactor": 5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|setColumns2node",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|setColumns2node",
            "rawNode": {
                "icon": "../../config/images/config/columns2node.png",
                "icon.dm_props": {
                    "width": 210,
                    "height": 180,
                    "scaleFactor": 5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|styles",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|styles",
            "rawNode": {
                "icon": "../../config/images/config/styles.png",
                "icon.dm_props": {
                    "width": 195,
                    "height": 180,
                    "scaleFactor": 5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                },
                "resetDefaultsBtn": "Reset defaults",
                "resetDefaultsBtn.dm_props": {
                    "name": "resetDefaultsBtn",
                    "label": "Reset defaults",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "level": 2,
                    "image": "../../images/refresh.png",
                    "imageName": "../../images/refresh.png",
                    "class": "btn-warning",
                    "content.exec" : "
dm_Tools.alignConfigTreeToColumnsNumber(node, true, 'styles') ;
dm_Datamap.refreshGraph(node);
"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|styles|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|styles|*",
            "rawNode": {
                "name.dm_props": {
                    "order": 0,
                    "visible": false,
                    "edit": false
                },
                "array index.dm_props": {
                    "order": 1,
                    "visible": false,
                    "edit": false
                },
                "level.dm_props": {
                    "order": 2,
                    "visible": false,
                    "edit": false
                },
                "arrow.dm_props": {
                    "order": 3,
                    "type": "boolean"
                },
                "arc.dm_props": {
                    "order": 4,
                    "type": "boolean"
                },
                "rNod.dm_props": {
                    "order": 5
                },
                "txtFontSize.dm_props": {
                    "order": 6                    
                },
                "link.dm_props": {
                    "order": 7
                },
                "color.dm_props": {
                    "order": 8
                },
                "attrPaneCol.dm_props": {
                    "order": 9
                },
                "txtCol.dm_props": {
                    "order": 10
                },
                "backgroundImage.dm_props": {
                    "order": 11
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|specifics",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|specifics",
            "rawNode": {
                "icon": "../../config/images/config/specifics.png",
                "icon.dm_props": {
                    "width": 180,
                    "height": 180,
                    "scaleFactor": 5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                }
            }
        },
         /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|props4globalSearch",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|props4globalSearch",
            "rawNode": {
                "icon": "../../config/images/config/search.png",
                "icon.dm_props": {
                    "width": 180,
                    "height": 180,
                    "scaleFactor": 4,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                }
            }
        },
       /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|displayProps",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|displayProps",
            "rawNode": {
                "icon": "../../config/images/config/displayProps.png",
                "icon.dm_props": {
                    "order": 0,
                    "width": 165,
                    "height": 180,
                    "scaleFactor": 4.5,
                    "panelMaxHeight": 180,
                    "visible": true,
                    "edit": false,
                    "textX": 3,
                    "type": "image"
                },
                "resetDefaultsBtn": "Reset defaults",
                "resetDefaultsBtn.dm_props": {
                    "order": 1,
                    "name": "resetDefaultsBtn",
                    "label": "Reset defaults",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "image": "../../images/refresh.png",
                    "imageName": "../../images/refresh.png",
                    "class": "btn-warning",
                    "content.exec" : "
dm_Tools.alignConfigTreeToColumnsNumber(node, true, 'displayProps') ;
dm_Datamap.refreshGraph(node);
"
                },
                "br": "<br/>",
                "br.dm_props": {
                    "order": 2,
                    "type": "rich text",
                    "edit": false
                },
                "borderAddPropIn": "borderAddPropIn",
                "borderAddPropIn.dm_props": {
                    "order": 90,
                    "type": "borderIn"
                },
                "propertyAddDropdown": "",
                "propertyAddDropdown.dm_props": {
                    "order": 91,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "
var doit = function() {
    var output = dm_Tools.getDisplayPropsNames(node) ;
    output = dm_Tools.feedPossibleProperties(node, output) ;
    return output ;    
}
doit() ;
",
                    "name": "propertyAddDropdown",
                    "label": "Choose existing property",
                    "placeHolder": "no property to add...",
                    "onChange": "
node.rawNode.propertyAddName = node.rawNode.propertyAddDropdown ;
node.rawNode.label = node.rawNode.propertyAddDropdown ;
var dp = dm_Tools.getFirstDisplayProp(node, node.rawNode.propertyAddName) ;
if(dp) {
    dm_Tools.copyPropsFromOrderRange(dp, 100, 200, node, true) ;
}
if(node.rawNode.type != 'graph') {
    delete node.rawNode.borderIn1 ;
    delete node.rawNode.graph ;
    delete node.rawNode.doTransition ;
    delete node.rawNode.predefinedGraphDropdown ;
    delete node.rawNode.graphProperty1 ;
    delete node.rawNode.graphDepth ;
    delete node.rawNode.textInPie ;
    delete node.rawNode.graphUnit1 ;
    delete node.rawNode.setFuncBtn ;
    delete node.rawNode.br ;
    delete node.rawNode.input ;
    delete node.rawNode.borderOut1 ;
}
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "execute1": "
if(node.rawNode.propertyAddDropdown != node.rawNode.propertyAddName) {
    if(!node.rawNode.propertyAddName || (node.rawNode.propertyAddName == '')) {
        node.rawNode.propertyAddName = node.rawNode.propertyAddDropdown ;
    }
    var dp = dm_Tools.getFirstDisplayProp(node, node.rawNode.propertyAddName) ;
    if(dp) {
        dm_Tools.copyPropsFromOrderRange(dp, 100, 200, node, true) ;
    }
    if(!node.rawNode.label || (node.rawNode.label == '')) {
        node.rawNode.label = node.rawNode.propertyAddDropdown ;
    }
    if(node.rawNode.type != 'graph') {
        delete node.rawNode.borderIn1 ;
        delete node.rawNode.graph ;
        delete node.rawNode.doTransition ;
        delete node.rawNode.predefinedGraphDropdown ;
        delete node.rawNode.graphProperty1 ;
        delete node.rawNode.graphDepth ;
        delete node.rawNode.textInPie ;
        delete node.rawNode.graphUnit1 ;
        delete node.rawNode.setFuncBtn ;
        delete node.rawNode.br ;
        delete node.rawNode.input ;
        delete node.rawNode.borderOut1 ;
    }
}
",
                "execute1.dm_props": {
                    "order": 92,
                    "type": "execute"
                },
                "propertyAddName": "",
                "propertyAddName.dm_props": {
                    "order": 93,
                    "type": "text",
                    "visible": true,
                    "edit": true,
                    "label": "Name of property to display"
                },
                /* --------------------------------------------------------------------- property options --------------------------------------------------*/
                "execute2": "
var output ;
if(node.rawNode.type != 'graph') {
    delete node.rawNode.borderIn1 ;
    delete node.rawNode.graph ;
    delete node.rawNode.doTransition ;
    delete node.rawNode.predefinedGraphDropdown ;
    delete node.rawNode.graphProperty1 ;
    delete node.rawNode.graphDepth ;
    delete node.rawNode.textInPie ;
    delete node.rawNode.graphUnit1 ;
    delete node.rawNode.setFuncBtn ;
    delete node.rawNode.br ;
    delete node.rawNode.input ;
    delete node.rawNode.borderOut1 ;
    output = '#dm_STOP_AND_REDRAW_ATTRIBUTES_PANEL#101' ;
} else {
    node.rawNode.borderIn1 = 'graphIn' ;
    node.rawNode.borderOut1 = 'graphOut' ;    
}
output ;
",
                "execute2.dm_props": {
                    "order": 100,
                    "type": "execute"
                },
                "visible": true,
                "visible.dm_props": {
                    "type": "boolean",
                    "order": 101
                },
                "edit": false,
                "edit.dm_props": {
                    "type": "boolean",
                    "order": 102
                },
                "label": "",
                "label.dm_props": {
                    "order": 103,
                    "type": "text",
                    "visible": true,
                    "edit": true,
                    "label": "Label of property to display"
                },
                "type": "",
                "type.dm_props": {
                    "order": 104,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "['text', 'graph', 'music']",
                    "name": "type",
                    "label": "type :",
                    "onChange": "
if(node.rawNode.type == 'graph') {
    node.rawNode.borderIn1 = 'graphIn' ;
    node.rawNode.graph = 'pie' ;
    node.rawNode.doTransition = true ;
    node.rawNode.predefinedGraphDropdown = '' ;
    
    var possibleProps = dm_Tools.feedPossibleProperties(node) ;
    if(possibleProps.indexOf(node.rawNode.propertyAddName) >= 0) {
        node.rawNode.graphProperty1 = node.rawNode.propertyAddName ;
    } else {
        node.rawNode.graphProperty1 = possibleProps[0] ;
    }

    node.rawNode.graphDepth = '' ;
    node.rawNode.textInPie = false ;
    node.rawNode.graphUnit1 = '' ;
    node.rawNode.setFuncBtn = 'Update graph function' ;
    //node.rawNode.br1 = '<br/>' ;
    node.rawNode.input = '' ;
    node.rawNode.borderOut1 = 'graphOut' ;
} else {
    delete node.rawNode.borderIn1 ;
    delete node.rawNode.graph ;
    delete node.rawNode.doTransition ;
    delete node.rawNode.predefinedGraphDropdown ;
    delete node.rawNode.graphProperty1 ;
    delete node.rawNode.graphDepth ;
    delete node.rawNode.textInPie ;
    delete node.rawNode.graphUnit1 ;
    delete node.rawNode.setFuncBtn ;
    delete node.rawNode.br ;
    delete node.rawNode.input ;
    delete node.rawNode.borderOut1 ;
}
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "borderIn1.dm_props": {
                    "order": 110,
                    "type": "borderIn",
                    "visible": true,
                    "displayEvenIfUndefined": true
                },
                "graph.dm_props": {
                    "order": 111,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "['pie']",
                    "name": "graph",
                    "label": "graph :",
                    "source": "user"
                },
                "doTransition.dm_props": {
                    "order": 112,
                    "type": "boolean"
                },
                "predefinedGraphDropdown.dm_props": {
                    "order": 113,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "['pie based on property']",
                    "name": "predefinedGraphDropdown",
                    "label": "predefined graph :",
                    "onChange": "
var possibleProps = dm_Tools.feedPossibleProperties(node) ;
if(node.rawNode.predefinedGraphDropdown == 'pie based on property') {
    if(possibleProps.indexOf(node.rawNode.propertyAddName) >= 0) {
        node.rawNode.graphProperty1 = node.rawNode.propertyAddName ;
    }
}
"
                },
                "graphProperty1.dm_props": {
                    "order": 114,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "dm_Tools.feedPossibleProperties(node);",
                    "name": "graphProperty1",
                    "label": "property :"
                },
                "graphUnit1.dm_props": {
                    "order": 115,
                    "type": "text",
                    "visible": true,
                    "edit": true,
                    "label": "Unit"
                },
                "graphDepth.dm_props": {
                    "order": 116,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "['1', '2', '3', '4']",
                    "name": "graphDepth",
                    "label": "depth level :"
                },
                "textInPie.dm_props": {
                    "order": 117,
                    "type": "boolean"
                },
                "br0": "<br/>",
                "br0.dm_props": {
                    "order": 118,
                    "type": "rich text",
                    "edit": false
                },
                "setFuncBtn.dm_props": {
                    "order": 120,
                    "name": "setFuncBtn",
                    "label": "Update graph function",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "image": "../../images/refresh.png",
                    "imageName": "../../images/refresh.png",
                    "class": "btn-info",
                    "content.exec" : "
var configRoot = node ;
while(configRoot.parent) configRoot = configRoot.parent ;
node.rawNode.input = dm_Tools.getChild(configRoot, 'displayProps').rawNode.predefinedGraphFunctions[node.rawNode.predefinedGraphDropdown] ;
node.rawNode.input = dm_Tools.replaceByProperties(node, node.rawNode.input) ;
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node) ;
"
                },
                "br1.dm_props": {
                    "order": 121,
                    "type": "rich text",
                    "edit": false
                },
                "input.dm_props": {
                    "order": 122,
                    "type": "javascript",
                    "visible": true,
                    "edit": true
                },
                "borderOut1.dm_props": {
                    "order": 130,
                    "type": "borderOut",
                    "visible": true,
                    "displayEvenIfUndefined": true
                },
                "ifCenter.dm_props": {
                    "type": "boolean"
                },
                /* -------------------------------------------------------------------- end property options -----------------------------------------------*/
                "addPropertyBtn": "Add property to all levels",
                "addPropertyBtn.dm_props": {
                    "order": 201,
                    "name": "addPropertyBtn",
                    "label": "Add property to all levels",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "image": "../../images/plus.png",
                    "imageName": "../../images/plus.png",
                    "class": "btn-success",
                    "content.exec" : "
var dpLevel, newNode ;
var newDPName = node.rawNode.propertyAddName ;
for(var i=0; i<node.children.length; i++) {
    newNode = null ;
    dpLevel = node.children[i] ;
    if(dpLevel.children) {
        newNode = dm_Tools.getChild(dpLevel, newDPName) ;
    }
    if(!newNode) {
        newNode = dm_Datamap.createNode(dpLevel, newDPName, true, true) ;
    }
    if(!newNode.rawNode) newNode.rawNode = {} ;
    dm_Tools.copyPropsFromOrderRange(node, 100, 200, newNode, true) ;
}
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "borderAddPropOut": "borderAddPropOut",
                "borderAddPropOut.dm_props": {
                    "order": 202,
                    "type": "borderOut"
                },
                "br2": "<br/>",
                "br2.dm_props": {
                    "order": 203,
                    "type": "rich text",
                    "edit": false
                },
                "borderDelPropIn": "borderDelPropIn",
                "borderDelPropIn.dm_props": {
                    "order": 204,
                    "type": "borderIn"
                },
                "propertyDeleteDropdown": "",
                "propertyDeleteDropdown.dm_props": {
                    "order": 205,
                    "type": "dropdown",
                    "visible": true,
                    "edit": false,
                    "dropdownList": "
var doit = function() {
    var output ;
    var dpLevel, dp ;
    for(var i=0; i<node.children.length; i++) {
        dpLevel = node.children[i] ;
        if(dpLevel.children) {
            for(var j=0; j<dpLevel.children.length; j++) {
                dp = dpLevel.children[j] ;
                if(!output) output = [] ;
                if(output.indexOf(dp.name) < 0) {
                    output.push(dp.name) ;
                }
            }
        }
    }
    return output ;
}
doit() ;
                    ",
                    "name": "propertyDeleteDropdown",
                    "label": "propertyDeleteDropdown",
                    "source": "user",
                    "placeHolder": "no property to delete..."
                },
                "deletePropertyBtn": "Delete property from all levels",
                "deletePropertyBtn.dm_props": {
                    "order": 206,
                    "name": "deletePropertyBtn",
                    "label": "Delete property from all levels",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "source": "user",
                    "image": "../../images/delete.png",
                    "imageName": "../../images/delete.png",
                    "class": "btn-danger",
                    "content.exec" : "
var dpLevel, newNode ;
var newDPName = node.rawNode.propertyDeleteDropdown ;
for(var i=0; i<node.children.length; i++) {
    dpLevel = node.children[i] ;
    var alreadyThere ;
    if(dpLevel.children) {
        alreadyThere = dm_Tools.getChild(dpLevel, newDPName) ;
    }
    if(alreadyThere) {
        dm_Datamap.removeNode(alreadyThere) ;
    }
}
dm_Datamap.focusNode(node) ;
dm_Datamap.refreshGraph(node);
"
                },
                "predefinedGraphFunctions": {
                    "pie based on property": "var output, elt;
var levelMin = node.level ;
var doIt = function(node) {
    if (!output) {
        output = [] ;
    }
    elt = {} ;
    output.push(elt) ;
    elt.value = node.rawNode['#replaceMeBy_graphProperty1#'] ;
    elt.name = dm_Tools.getNodePath(node, '\\n', true, null, levelMin+1) ;
    elt.unit = '#replaceMeBy_graphUnit1#' ;
};
var parentLevel = node.level ;
var depth = #replaceMeBy_graphDepth# ;
var dive = function(node) {
    if (node) {
        if (node.level == parentLevel + depth) {
            doIt(node);
        } else if ((node.level < parentLevel + depth) && (node.children)) {
            node.children.forEach(function(child) {
                dive(child);
            });
        }
    }
} ;
dive(node);
return output;"
                },
                "borderDelPropOut": "borderDelPropOut",
                "borderDelPropOut.dm_props": {
                    "order": 207,
                    "type": "borderOut"
                },
                "predefinedGraphFunctions.dm_props": {
                    "visible": false,
                    "edit": false
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|displayProps|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|displayProps|*",
            "rawNode": {
                "array index.dm_props": {
                    "edit": false,
                    "visible": false
                },
                "level.dm_props": {
                    "edit": false,
                    "visible": false
                },
                "edit.dm_props": {
                    "type": "boolean",
                    "order": 10,
                    "displayEvenIfUndefined": true
                },
                "visible.dm_props": {
                    "type": "boolean",
                    "order": 11,
                    "displayEvenIfUndefined": true
                },
                "applyToBrothersBtn": "Apply to all brothers",
                "applyToBrothersBtn.dm_props": {
                    "order": 21,
                    "name": "applyToBrothersBtn",
                    "label": "Apply to all brothers",
                    "visible": true,
                    "edit": false,
                    "type": "action",
                    "image": "../../images/refresh.png",
                    "imageName": "../../images/refresh.png",
                    "class": "btn-info",
                    "content.exec" : "
var child, parent = node.parent ;
for(var i=0; i<parent.children.length; i++) {
    child = parent.children[i] ;
    dm_Tools.copyPropsFromOrderRange(node, 10, 20, child, true) ;
}
//dm_Datamap.focusNode(node) ;
//dm_Datamap.refreshGraph(node);
"
                }
            }
        },
        /* ----------------------------------------------------------------------------------------------------------------------------------------
                     "name": "$dm_root|displayProps|*|*",
           ----------------------------------------------------------------------------------------------------------------------------------------*/
        {
            "name": "$dm_root|displayProps|*|*",
            "rawNode": {
                "loadPropsFromGdParent": "
var configRoot = node ;
while(configRoot.parent) configRoot = configRoot.parent ;
var displayPropsNode = dm_Tools.getChild(configRoot, 'displayProps') ;
dm_Tools.copyPropsFromOrderRange(displayPropsNode, 100, 200, node, false, true) ;

if(node.rawNode.type != 'graph') {
    delete node.rawNode.borderIn1 ;
    delete node.rawNode.graph ;
    delete node.rawNode.doTransition ;
    delete node.rawNode.predefinedGraphDropdown ;
    delete node.rawNode.graphProperty1 ;
    delete node.rawNode.graphDepth ;
    delete node.rawNode.textInPie ;
    delete node.rawNode.graphUnit1 ;
    delete node.rawNode.setFuncBtn ;
    delete node.rawNode.br ;
    delete node.rawNode.input ;
    delete node.rawNode.borderOut1 ;
} else {
    node.rawNode.borderIn1 = 'graphIn' ;
    node.rawNode.borderOut1 = 'graphOut' ;    
}

'#dm_STOP_AND_REDRAW_ATTRIBUTES_PANEL#' ;
",
                "loadPropsFromGdParent.dm_props": {
                    "order": 0,
                    "type": "execute"
                }
            }
        }
        ]
    }
}