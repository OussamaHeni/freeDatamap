function dm_tools_NameIdList(){this.listByName={},this.listById={};var a=this;this.resyncId=function(){var b=0;for(var c in a.listById)b=Math.max(b,c);dm_Tools.counter<=b&&(dm_Tools.counter=b)},this.updateName=function(b){var c=a.listByName[b.name];c||(c=[],a.listByName[b.name]=c),c.push(b)},this.addObject=function(b){!b.id||dm_tools_NameIdList.forceId?b.id=dm_Tools.getId():dm_Tools.counter<=b.id&&(dm_Tools.counter=b.id+1),a.listById[b.id]&&(b.id=dm_Tools.getId()),a.listById[b.id]=b,a.updateName(b)},this.updateNames=function(){a.listByName={};var b;for(var c in a.listById)b=a.listById[c],a.updateName(b)},this.removeObject=function(b){var c;if(b.id&&delete a.listById[b.id],b.name){var d=a.listByName[b.name];d&&(c=d.indexOf(b.name),c>=0&&d.splice(c,1))}},this.getObject=function(b){return a.listById[b]},this.getObjects=function(b){return a.listByName[b]},this.getFirstObject=function(b){var c,d=a.listByName[b];return d&&d.length>0&&(c=d[0]),c},this.updateAndGetNames=function(){return a.updateNames(),a.getNames()},this.getNames=function(){var b=[];for(var c in a.listByName)b.push(c);return b},this.setAll=function(b){var c;for(var d in a.listById){c=a.listById[d];for(var e in b)c[e]=b[e]}},this.getAll=function(){var b=[];for(var c in a.listById)b.push(a.listById[c]);return b},this.concat=function(b){for(id in b.listById)a.addObject(b.listById[id]);return a}}function dm_Tools(){}function dm_Csv(a,b,c){this.dataTable,this.root,this.nodes=new dm_tools_NameIdList;var d=b.columns,e=b.root,f=b.setColumns2node,g=b.styles,h=b.options;this.options=h||{};var i=this,j=function(){for(var c,e,f,g=[],h=1;h<a.length;h++){if(c=a[h],g.length<c.length)for(var i=g.length;i<c.length;i++)f={},f.dm_columnName=a[0][i],f.dm_columnIndex=i,g.push(f);for(var i=0;i<c.length;i++)e=c[i],e&&""!=e?(g[i][e]||(g[i][e]=0),g[i][e]++):(g[i].dm_numberOfEmpty||(g[i].dm_numberOfEmpty=2),g[i].dm_numberOfEmpty++)}var j=function(a){var b=Object.keys(a).length;return b-=2};g.sort(function(a,b){return j(a)==j(b)?0:j(a)<j(b)?-1:1});var k=b.maxNbOfColumns2tree||10;k=Math.min(k,g.length),b.columns=[];for(var h=0;k>h;h++)b.columns.push({columnIndex:g[h].dm_columnIndex,name:g[h].dm_columnName}),console.log(j(g[h]),g[h].dm_columnName,g[h]);d=b.columns},k=function(a,b){for(var c=0,d=0;d<b.length;d++){var e=b[d];a[e]&&(c=d)}return c},l=function(a,b){for(var c=-1,d=0;0>c&&d<b.length;d++){var e=b[d];a[e]||(c=d)}return c},m=function(){var b,c,h,m,p,r,s,t,u,v,w;for(d&&0!=d.length||j(),m=1;m<a.length;m++){b=a[m],c=e,h=null;var x=function(a){var b=a;return isNaN(a)&&(dm_Tools.isArray(a)||"object"==typeof a&&(b=a.columnIndex)),b};if(v=k(b,d),w=l(b,d),d){u=null;var y,z=!1;if("rejectHolesInRows"==i.options.readMode){var A=!1;for(p=0;!A&&p<d.length;p++)y=x(d[p]),b[y]||(A=!0);z=A}else"rejectHolesInBranch"==i.options.readMode&&w>=0&&v>w&&(z=!0);for(p=0;p<d.length;p++){if(y=x(d[p]),dm_Tools.isArray(y))for(t=y,s="",r=0;r<t.length;r++)r>0&&(s+=" "),s+=b[t[r]];else s=b[y];if(s)u=s,h=z?o(c,h,!0):n(c,s,b,g[p+1],h,f),c=s;else if(p==k(b,d)+1&&h){var B=o(u,h,!0);B&&q(B,b,f,!0)}}}}},n=function(a,b,c,d,e,f){var g,h,i;return g=p(e,a,c,f),h=p(g,b,c,f,d),i=g.children||(g.children=[]),i.indexOf(h)<0&&i.push(h),g},o=function(a,b,c){a=dm_Tools.decodeValue(a,i.options.decodeURI);var d,e=i.nodes.getObjects(a);if(e)if(!b&&e.length>0)d=e[0];else for(var f,g=dm_Tools.getNodePath(b),h=e.length-1;h>=0;h--)f=e[h],f.parent&&dm_Tools.getNodePath(f.parent)==g&&(d=f);return d||c||(d={name:a,parent:b},i.nodes.addObject(d)),d},p=function(a,b,c,d,e){var f;return f=o(b,a),e&&(f.level||(f.level=e.level,q(f,c,d))),i.root||(f.level=0,i.root=f),f},q=function(b,d,e,f){if(d){var g,h,j,k=a[0],l=function(a,b){c&&(j=c[b],j&&j.indexOf(a)<0&&j.push(a))};if(!b.rawNode||f)if(b.rawNode={},e&&e[b.level])for(var m,n=e[b.level].length,o=0;n>o;o++)m=e[b.level][o],isNaN(m)?(g=m,m=k.indexOf(m)):g=k[m],h=d[m],b.rawNode[g]=dm_Tools.decodeValue(h,i.options.decodeURI),l(h,g);else for(var g,n=k.length,o=0;n>o;o++)g=k[o],h=d[o],b.rawNode[g]=dm_Tools.decodeValue(h,i.options.decodeURI),l(h,g)}};m()}function dm_LDIF(){}function dm_Freemind(){}function dm_Json2tree(a,b){this.nodes=new dm_tools_NameIdList;var c=this,d=function(a){var e,f;dm_Tools.bestEffortLevel(a);for(e in a)dm_Json2tree.reservedProps.indexOf(e)<0&&(a.rawNode||(a.rawNode={}),a.rawNode[e]=a[e]);if(a.rawNode)for(e in a.rawNode)f=a.rawNode[e],listValue=b[e],listValue&&listValue.indexOf(f)<0&&listValue.push(f);c.nodes.addObject(a),a.children&&a.children.forEach(function(b){b&&(b.parent=a,d(b))})};d(a)}dm_tools_NameIdList.forceId=!1,dm_tools_NameIdList.idCounter=0,function(){try{Object.defineProperty(Object.prototype,"__dm_uniqueId",{writable:!0,enumerable:!1}),Object.defineProperty(Object.prototype,"dm_uniqueId",{get:function(){return void 0==this.__dm_uniqueId&&(this.__dm_uniqueId=++dm_tools_NameIdList.idCounter),this.__dm_uniqueId}})}catch(a){}}(),dm_Tools.fakeFranceLabs=!0,dm_Tools.FranceLabsIntegration=!0,dm_Tools.counter=0,dm_Tools.now=(new Date).getTime(),dm_Tools.timers={},dm_Tools_dm_config_name="dm_config",dm_Tools_constantDmConfigTreeRootName="_"+dm_Tools_dm_config_name,dm_Tools_connected="connected",dm_Tools_aggregatedConnected="aggregatedConnected",dm_Tools.delayTimeoutId,dm_Tools.delay=function(a,b){clearTimeout(dm_Tools.delayTimeoutId),dm_Tools.delayTimeoutId=setTimeout(a,b||300)},dm_Tools.getDelay=function(a){var b=(new Date).getTime(),c=b-dm_Tools.now;return a?(dm_Tools.timers[a]&&(c=b-dm_Tools.timers[a]),dm_Tools.timers[a]=b):dm_Tools.now=b,c},dm_Tools.getId=function(a){var b;return++dm_Tools.counter,b=a?""+a+"("+dm_Tools.counter+")":dm_Tools.counter},dm_Tools.isInAvoidProps=function(a,b){var c=!1;return b&&("string"==typeof b&&a==b?c=!0:b.indexOf(a)>=0&&(c=!0)),c},dm_Tools.setUniqueID=function(a){if(a){for(var a,b,c,d,e={},f={},g=[a],h=0,i=!1,j=function(a){a&&"object"==typeof a&&!e[a.dm_uniqueId]&&(e[a.dm_uniqueId]=a,g.push(a))};g.length>0;){a=g.pop(),i=!1,a.__dm_uniqueId||(i=!0);var k=e[a.dm_uniqueId];if(k&&(i?(d={},a.__dm_uniqueId=d.dm_uniqueId):f[k.dm_uniqueId]&&(d={},k.__dm_uniqueId=d.dm_uniqueId)),i&&(f[a.dm_uniqueId]=a),h=Math.max(h,a.dm_uniqueId),dm_Tools.isArray(a))for(b=a.length-1;b>=0;b--)j(a[b]);else for(c in a)j(a[c])}return h}},dm_Tools.deepCopyDmNode=function(a){return dm_Tools.deepCopy(a,["parent","aggregatedConnectedTo","aggregatedConnectedFrom"])},dm_Tools.deepCopy=function(a,b,c,d,e,f,g,h,i){var j=a;if(h||(h=a,dm_Tools.setUniqueID(h)),g===!0)g=dm_Tools.getDepth(a);else if((0===g||g>0)&&a!=h&&a.parent&&dm_Tools.getDepth(a)<=g)return;if(a&&"object"==typeof a){var k;if(d&&(k=d[a.dm_uniqueId]),d&&k){var l=e[a.dm_uniqueId];c?(j="$ref_"+l.dm_uniqueId,f||(f=[]),f.push(j)):j=k}else{var m;d||(d={}),d[a.dm_uniqueId]=a;var n,o=dm_Tools.isArray(a);if(o?(n=a.length,j=new Array(n)):j={},e||(e={}),e[a.dm_uniqueId]=j,o)for(var p=0;n>p;p++)m=a[p],j[p]=m&&"object"==typeof m?dm_Tools.deepCopy(m,b,c,d,e,f,g,h):m;else{a.prototype&&(j.prototype=a.prototype);for(var q in a)if("__dm_uniqueId"!=q){var r=!0;dm_Tools.isInAvoidProps(q,b)&&(r=!1),i&&dm_Tools.isInAvoidProps(q,i)&&(r=!1),m=a[q],r&&(j[q]=m&&"object"==typeof m?dm_Tools.deepCopy(m,b,c,d,e,f,g,h):m)}}}}return j},dm_Tools.cloneAndFixCircularRefs=function(a,b,c){var d=[],e=dm_Tools.deepCopy(a,b,!0,null,null,d,!0,c);return e&&d.length>0&&(e.$circularRefs=!0),e},dm_Tools.stringify=function(a,b,c){var d;try{d=JSON.stringify(a)}catch(e){var f=dm_Tools.cloneAndFixCircularRefs(a,b,c);d=JSON.stringify(f)}return d},dm_Tools.getMaxUniqueId=function(a){for(var b,c,d,e=[a],f=0;e.length>0;)if(b=e.pop(),b&&"object"==typeof b){d=b.__dm_uniqueId,d&&(f=Math.max(f,d));for(c in b)e.push(b[c])}return f},dm_Tools.removeProps=function(a,b){if(a&&"object"==typeof a){var c,d,e,f,g=[a],h={},i=0,j=[a];for(h[a.dm_uniqueId]=a;g.length>0;){c=g.pop(),h[c.dm_uniqueId]=c;for(var d in c)e=c[d],e&&"object"==typeof e&&!h[e.dm_uniqueId]&&(g.push(e),j.push(e))}for(;j.length>0;)if(c=j.pop(),"string"==typeof b)delete c[b];else for(f=b.length-1;f>=0;f--)delete c[b[f]];return i}},dm_Tools.allObj=function(a,b,c,d,e){dm_tools_NameIdList.idCounter=dm_Tools.getMaxUniqueId(a)+1,dm_Tools.setUniqueID(a);var b=b||{},c=c||[],d=d||[],e=e||[],f=!1,g=[];g.push(a);for(var h=function(h){f="string"==typeof i&&0==i.indexOf("$ref_"),i&&(f||"object"==typeof i&&!b[i.__dm_uniqueId])&&(f&&(c.push(i),d.push(a),e.push(h)),g.push(i))};g.length>0;)if(a=g.pop(),a&&"object"==typeof a){var i;if(dm_Tools.isArray(a))for(var j=a.length,k=0;j>k;k++)i=a[k],h(k);else{b[a.__dm_uniqueId]=a;for(var l in a)i=a[l],h(l)}}return{list:b,refs:{refsList:c,parents:d,keys:e}}},dm_Tools.replaceRef=function(a,b){var c;if(a&&"string"==typeof a&&0==a.indexOf("$ref_")){var d=a.substring("$ref_".length);c=b[d]}return c},dm_Tools.rebuildRefs=function(a){console.log("rebuildRefs start "+dm_Tools.getDelay());for(var b,c,d,e,f=dm_Tools.allObj(a),g=f.list,h=f.refs.refsList,i=f.refs.parents,j=f.refs.keys,k=h.length-1;k>=0;k--)b=h[k],e=dm_Tools.replaceRef(b,g),e&&(c=i[k],d=j[k],c[d]=e);return delete a.$circularRefs,dm_Tools.removeProps(a,"__dm_uniqueId"),console.log("rebuildRefs end "+dm_Tools.getDelay()),a},dm_Tools.changeNewLinesFromJSONStrings=function(a,b){for(var c=0,d=c,e=-1,f="";c>=0;)d=c,c=a.indexOf('"',c+1),c>=0?"\\"!=a[c-1]&&(e>=0?(f+='"',f+=b?a.substring(e+1,c).replace(/\\n/g,"\n"):a.substring(e+1,c).replace(/\r\n/g,"\\n").replace(/\n/g,"\\n").replace(/\r/g,"\\n").replace(/\t/g," "),f+='"',c++,e=-1):(f+=a.substring(d,c),e=c)):f+=a.substring(d,a.length);return f},dm_Tools.parseStringified=function(a,b){var c=a;if("string"==typeof a){var a=a.replace(/\/\*[\s\S]+?\*\//g,"");a=dm_Tools.changeNewLinesFromJSONStrings(a),c=JSON.parse(a),b===!1||1!=b&&!c.$circularRefs||(c=dm_Tools.rebuildRefs(c))}return c},dm_Tools.ARRAY_PROPS={length:"number",sort:"function",slice:"function",splice:"function"},dm_Tools.isArray=function(a){if(!a||"number"==typeof a||"string"==typeof a||"boolean"==typeof a)return!1;if(a instanceof Array)return!0;for(var b in dm_Tools.ARRAY_PROPS)if(!(b in a&&typeof a[b]==dm_Tools.ARRAY_PROPS[b]))return!1;return!0},dm_Tools.indent=function(a){var b="";for(i=0;a>i;i++)b+="  ";return b},dm_Tools.restoreParentsInTree=function(a,b){if(a.parent=b,a.children)for(var c,d=a.children.length,e=0;d>e;e++)c=a.children[e],dm_Tools.restoreParentsInTree(c,a);return a},dm_Tools.getNodesFromRoot=function(a,b){if(b||(b=new dm_tools_NameIdList),b.addObject(a),a.children)for(var c,d=a.children.length,e=0;d>e;e++)c=a.children[e],dm_Tools.getNodesFromRoot(c,b);return b},dm_Tools.isAdminConfigTreeNode=function(a){var b;return a&&a.name&&a.name.lastIndexOf(dm_Tools_constantDmConfigTreeRootName)>=0&&(b=a),b},dm_Tools.node2string=function(a,b,c,d,e,f,g){var h,i,j,k="",l=!0,m=!0;if(b=b||0,!a)return k;if(g&&dm_Tools.isAdminConfigTreeNode(a))return k;if(e>=b&&(a.children||!f))if("number"==typeof a||"string"==typeof a)k+=dm_Tools.indent(b+d),k+='"'+a+'"';else{k+=dm_Tools.indent(b+d),k+="{",l=!0;for(var n in a){i="";var o=!1;if(c)for(h=0;!o&&h<c.length;h++)c[h]==n&&(o=!0);"parent"==n?a.parent&&a.parent.name&&(i='"parent": '+(a.parent?'"'+a.parent.name+(a.parent.id?"("+a.parent.id+")":"")+'"':null)):"children"==n||o||(j=dm_Tools.stringify(a[n]),j||(j="null"),i='"'+n+'"'+": "+j),""!=i&&(l||(k+=","),k+="\n",k+=dm_Tools.indent(b+d),k+=i,l=!1)}if(a.children){for(l||(k+=","),k+="\n",k+=dm_Tools.indent(b+d),l=!1,k+='"children": [',m=!0,h=0;h<a.children.length;h++)m=!1,k+="\n",k+=dm_Tools.node2string(a.children[h],b+1,c,d,e,f),h<a.children.length-1&&(k+=",");m||(k+="\n"+dm_Tools.indent(b+d)),k+="]\n"}l||(a.children||(k+="\n"),k+=dm_Tools.indent(b+d)),k+="}"}return k},dm_Tools.nodes2string=function(a,b,c,d){var e="{\n";for(var f in a)e+=dm_Tools.indent(1)+f+":\n",e+=dm_Tools.node2string(a[f],1,b,1,c,d);return e+="}"},dm_Tools.get,dm_Tools.getAbsoluteLevel=function(a){return a.parent?dm_Tools.getAbsoluteLevel(a.parent)+1:0},dm_Tools.getLevelInternal=function(a,b){return!a.parent||a[dm_Tools_dm_config_name]&&!b?0:dm_Tools.getLevelInternal(a.parent)+1},dm_Tools.getLevel=function(a){return dm_Tools.getLevelInternal(a)},dm_Tools.bestEffortLevel=function(a){if(a){var b=a.level;if(!b){null==b&&a.style&&(b=a.style.level);var c=dm_Tools.getLevel(a);(null==b||c>b)&&!a[dm_Tools_dm_config_name]&&(b=c),null!=b||a.parent||(b=0),a.level=b||0}return b}},dm_Tools.links2string=function(a,b){for(var c,d="[\n",e=a.length,f=0;e>f;f++){c=a[f],d+=dm_Tools.indent(1);var g=!0,h=!1;for(var i in c)g||(d+=", "),"source"==i||"target"==i?(d+=i+":\n"+(b?c[i].name+"\n":dm_Tools.node2string(c[i],2)),d+=dm_Tools.indent(1),g=!0,h=!0):(d+=i+": "+dm_Tools.stringify(c[i]),g=!1);h&&f<a.length-1&&(d+="\n",h=!1),d+="\n"}return d+="]"},dm_Tools.removeSpaces=function(a){var b;return a&&(b=a.replace(/ /g,""),b=a.replace(/\./g,"_")),b},dm_Tools.compare=function(a,b){var c=!1;return a&&b&&(a=dm_Tools.removeSpaces(a.toLowerCase()),b=dm_Tools.removeSpaces(b.toLowerCase()),c=a==b),c},dm_Tools.saveFile=function(a,b,c,d,e){if(!e){for(var f=new Uint8Array(a.length),g=0;g<a.length;g++)f[g]=255&a.charCodeAt(g);a=f}try{saveAs(new Blob([a],{type:c+(d?";charset="+d:""),charset:d}),b)}catch(h){var i=new BlobBuilder;i.append(a),saveAs(i.getBlob("data:"+c+(d?";charset="+d:"")),b)}},dm_Tools.color2rgb=function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},dm_Tools.rgbParse=function(a){var b=/^rgb\(?[ ]*([0-9]*),[ ]*([0-9]*),[ ]*([0-9]*)\)/i.exec(a);return b?{r:parseInt(b[1]),g:parseInt(b[2]),b:parseInt(b[3])}:null},dm_Tools.rgb2hex=function(a){var b=function(a){for(var b=a.toString(16);b.length<2;)b="0"+b;return b};return"#"+b(a.r)+b(a.g)+b(a.b)};var d3_scale_category20_range=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],d3_scale_category20b_range=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"];dm_Tools.colors=d3_scale_category20_range.concat(d3_scale_category20b_range).concat(d3_scale_category20b_range).concat(d3_scale_category20b_range),dm_Tools.colorsRGB=[];for(var i=0;i<dm_Tools.colors.length;i++)dm_Tools.colorsRGB.push(dm_Tools.color2rgb(dm_Tools.colors[i]));dm_Tools.colors2=dm_Tools.colors,dm_Tools.colorsRGB2=dm_Tools.colorsRGB,dm_Tools.convertNumber=function(a,b,c){var d,e,f=a;return b||(b=1),"number"==typeof a&&(f=""+f,c&&(a>=1e6&&(e="M",a/=1e6),a>=1e3&&(e="k",a/=1e3)),f=a,a!=Math.round(a)&&(f=""+a.toFixed(b),d=f.lastIndexOf("."),d>=0&&0==parseInt(f.substr(d+1,b))&&(f=f.substring(0,d))),f=(""+f).replace(/\,/g," "),f=(""+f).replace(/\./g,","),f=(""+f).replace(/\B(?=(\d{3})+(?!\d))/g," "),c&&e&&(f+=" "+e)),f},dm_Tools.sortChildren=function(a,b,c){if(b){var d=function(a,b){var c;return c=a.rawNode[b],c||(c=a.name),c},e=function(a){return!a.children||0==a.children.length};a.sort(function(a,f){var g=0,h=(e(a),e(f),d(a,b)),i=d(f,b),j=-1,k=1;return(1==c||"true"==c)&&(j=1,k=-1),g=h==i?0:i>h?j:k})}},dm_Tools.sortTree=function(a,b){if(a){var c,d,e,f=null;if(d=dm_Tools.bestEffortLevel(a),f=b.styles[d+1]&&null!=b.styles[d+1].sort?b.styles[d+1].sort:b.sort,f&&(e=b.styles[d+1]&&null!=b.styles[d+1].sortDescendant?b.styles[d+1].sortDescendant:b.sortDescendant,a.children&&a.children.length>0)){for(c=0;c<a.children.length;c++)dm_Tools.sortTree(a.children[c],b);dm_Tools.sortChildren(a.children,f,e)}}},dm_Tools.rtfFontSize=function(a){var b=[8,10,12,14,18,24],c=10;return a&&a>=1&&(c=a-1<b.length?b[a-1]:b[b.length-1]),c=2*c},dm_Tools.getIndexOfFirstPipe=function(a,b){var c=-1,d=a.indexOf("|",b),e=a.indexOf("%7C",b);return c=0>d&&e>=0?e:0>e&&d>=0?d:Math.min(d,e)},dm_Tools.getFileExtension=function(a){var b,c=a.lastIndexOf("."),d=dm_Tools.getIndexOfFirstPipe(a,c);return c>=0&&(b=d>=0?a.substring(c+1,d):a.substring(c+1)),b},dm_Tools.getDatamapNameAndPathFromFullPath=function(a){var b={name:null,path:null,url:null};if(0==a.indexOf("http:"))b.url=a,b.name=a;else{var c=dm_Tools.getIndexOfFirstPipe(a);0>c?b.name=a:(b.name=a.substring(0,c),a.length>c+1&&(b.path=a.substring(c+1)))}return b},dm_Tools.getGotoTarget=function(a){return a&&a.rawNode&&a.rawNode.dm_goto&&""!=a.rawNode.dm_goto?dm_Tools.getDatamapNameAndPathFromFullPath(a.rawNode.dm_goto):void 0},dm_Tools.getChildAt=function(a,b){var c;return a&&a.children&&b<a.children.length&&(c=a.children[b]),c},dm_Tools.getChildNameAt=function(a,b){var c,d=dm_Tools.getChildAt(a,b);return d&&(c=d.name),c},dm_Tools.getChildIndexAndObj=function(a,b,c){var d;if(null==c&&(c=!0),a){var e,f;if(a.children)for(e=0;!d&&e<a.children.length;e++)f=a.children[e],dm_Tools.equalsOrRexgexpMatch(b,f.name)&&(d={index:e,obj:f,isDmChild:!1});if(!d&&c&&a.dm_children)for(e=0;!d&&e<a.dm_children.length;e++)f=a.dm_children[e],dm_Tools.equalsOrRexgexpMatch(b,f.name)&&(d={index:e,obj:f,isDmChild:!0})}return d},dm_Tools.getChild=function(a,b,c){var d=dm_Tools.getChildIndexAndObj(a,b,c);return d&&(d=d.obj),d},dm_Tools.getChildIndex=function(a,b,c){var d=dm_Tools.getChildIndexAndObj(a,b,c);return d&&!d.isDmChild&&(d=d.index),d},dm_Tools.getParent=function(a,b){var c;return a&&(c=a.name==b?a:dm_Tools.getParent(a.parent,b)),c},dm_Tools.getNodePathNames=function(a){var b;return a.parent?(b=dm_Tools.getNodePathNames(a.parent),b.push(a.name)):b=[a.name],b},dm_Tools.getNodePathNamesRespectingLevels=function(a){var b;if(a.parent){b=dm_Tools.getNodePathNames(a.parent);var c=a.level;a.style&&a.style.level&&(c=a.level);for(var d=b.length;c>d;d++)b.push("");b.push(a.name)}else b=[a.name];return b},dm_Tools.getNodePath=function(a,b,c,d,e,f,g){var h,e=e?e:0,b=null==b?"|":b;if(a)if(d&&(h=a.rawNode[d]),h||(h=a.name),a.parent&&(0==e||a.level&&a.level>=e)){if(!c||!a.dm_config){var i=dm_Tools.getNodePath(a.parent,b,c,d,e,!0,g);h=i?i+b+h:h}}else!f||g&&!a.parent||(h=null);return h},dm_Tools.getNodeUrl=function(a,b,c,d){var c=c;if(!c){for(var e=a;e&&e.parent;)e=e.parent;var f;e&&(f=e.dm_DatamapName);var g=dm_Datamap.currentDatamap.name;c=f||g}return("noDatamapNameInURL"==c?"":c+"|")+dm_Tools.getNodePath(a,null,d,null,null,null,b)},dm_Tools.getNodeFromPath=function(a,b,c){c=c||dm_Datamap.currentDatamap;var d,e,f,g,h={found:null,lastFoundNode:b,dm:c,nextPath:a};return f=dm_Tools.getIndexOfFirstPipe(a),f>0?(d=a.substring(0,f),a.length>f+1&&(e=a.substring(f+1))):""!=a&&(d=a),d&&(g=b||d!=c.root.name?b||e?b?dm_Tools.getChild(b,d):c.nodes.getFirstObject(d):c.nodes.getFirstObject(d):c.root,e?(h=dm_Tools.getNodeFromPath(e,g,c),h.lastFoundNode=h.lastFoundNode||g||b,h.nextPath=h.nextPath||e):h={node:g,lastFoundNode:b,dm:c,nextPath:e}),h},dm_Tools.getNodeFromUrl=function(a){var b,c,d=a;if(c=d.indexOf("|"),c>0){var e=dm_Datamap.maps[a.substring(0,c)];e&&(d=d.substring(c+1),b=dm_Tools.getNodeFromPath(d,null,e).node)}return{datamap:e,node:b}},dm_Tools.escapeHtmlEntitiesTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"},dm_Tools.convertAccent2html=function(a){return a.replace(/[\u00A0-\u2666<>\&]/g,function(a){return"&"+(dm_Tools.escapeHtmlEntitiesTable[a.charCodeAt(0)]||"#"+a.charCodeAt(0))+";"})},dm_Tools.searchFirstDomNodeFromPath=function(a,b,c){if(a&&b){var d;if(c)for(var e=a.firstChild;e&&!d;e=e.nextSibling)d=dm_Tools.searchFirstDomNodeFromPath(e,b);else{var f=b.indexOf("/"),g=b;if(f>=0?(g=b.substring(0,f),b=b.substring(f+1)):b=null,g&&1==a.nodeType&&(a.nodeName.toUpperCase()==g.toUpperCase()&&(d=a),d&&b&&a.firstChild)){d=null;for(var e=a.firstChild;e&&!d;e=e.nextSibling)d=dm_Tools.searchFirstDomNodeFromPath(e,b)}}return d}},dm_Tools.getDomNodeAttribute=function(a,b){var c,d;if(a&&b){for(var e=0;!c&&e<a.attributes.length;e++)d=a.attributes[e],d.name==b&&(c=d);return c}},dm_Tools.setDomNodeAttribute=function(a,b,c){if(a&&b){var d=dm_Tools.getDomNodeAttribute(a,b);d?d.value=c:a.setAttribute(b,c)}},dm_Tools.finishXmlTags=function(a){for(var b,c,d,e,f,g=a,h=g.indexOf("/>");h>0;)b=g.substring(0,h),c=g.substring(h+2),d=b.lastIndexOf("<"),e=b.substring(d+1),f=e.indexOf(" "),0>f&&(f=e.length),e=e.substring(0,f),g=b+"></"+e+">"+c,h=g.indexOf("/>");return g},dm_Tools.getMaxDepth=function(a,b){var b=b||0,c=b;if(a.children)for(var d=0;d<a.children.length;d++){var e=dm_Tools.getMaxDepth(a.children[d],b+1);e>c&&(c=e)}return c},dm_Tools.convertValue=function(a){return a||(a=""),a=dm_Tools.convertNumber(a)},dm_Tools.prop2obj=function(a,b){if("__dm_uniqueId"==b)return{};var b=b,c=a.rawNode||a;b.indexOf(".")>0&&(b=b.substring(0,b.indexOf(".")));var d=c[b],e=c[b+".dm_props"];e||(e={});var f=!1;for(var g in c)g!=b+".dm_props"&&0==g.indexOf(b+".")&&g.length>b.length+1&&(f=!0,e[g.substring(b.length+1)]=e[g.substring(b.length+1)]||c[g],delete c[g]);return f&&(c[b+".dm_props"]=e),"object"==typeof e&&(e.name=b,"image"==e.type&&(e.imageName=d)),e},dm_Tools.scanAllProps=function(a,b){if(a){var c=a.rawNode||a;for(var d in c)b&&b(c,d);a[dm_Tools_dm_config_name]&&dm_Tools.scanAllProps(a[dm_Tools_dm_config_name],b),a.children&&a.children.forEach(function(a){dm_Tools.scanAllProps(a,b)}),a.styles&&a.styles.forEach(function(a){dm_Tools.scanAllProps(a,b)}),a.aggregate&&a.aggregate.forEach(function(a){dm_Tools.scanAllProps(a,b)}),a.displayProps&&a.displayProps.forEach(function(a){dm_Tools.scanAllProps(a,b)})}},dm_Tools.prop2objAll=function(a){dm_Tools.scanAllProps(a,dm_Tools.prop2obj)},dm_Tools.setSpecificsFromConfig=function(a){var b=a.specifics;if(b)for(var c=null,d=null,e=null,f=null,g=0;g<b.length;g++)if(c=b[g],d=c.name,e=dm_Tools.getNodeFromPath(d),e&&e.node){f=e.node,f.rawNode||(f.rawNode={});for(var h in c.rawNode)f.rawNode[h]=c.rawNode[h]}},dm_Tools.onDisplayableRawNodeProps=function(a,b,c,d,e,f,g){var g=g||dm_Tools.getConfig(a),h=g.displayProps;g.adminProps,c||(c="");var i,j=[],k=function(a){if(0!=a.label.indexOf("dm_hoTable_level_")){for(var b,c=null,d=0;d<j.length&&!c;d++)b=j[d],b.propObj.name==a.propObj.name&&(c=b.propObj);c||j.push(a)}};if(a.rawNode){var l=function(b){var c,d=!0;for(var e in a.rawNode)if(e.indexOf(".")<0&&(b&&(d=!1,dm_Tools.isArray(b)&&b.indexOf(e)>=0?d=!0:e==b&&(d=!0)),d)){var c=dm_Tools.prop2obj(a,e);("true"==c.visible||1==c.visible||"true"==c.edit||1==c.edit)&&(f&&1==c.dontExport||k({propObj:c,label:e,value:dm_Tools.convertValue(a.rawNode[e]),order:j.length+1}))}};l(["icon","image"]);var m=g.styles[a.level];for(var n in m){var o=dm_Tools.prop2obj(m,n);o.visible&&k({propObj:o,label:n,value:o[n],order:j.length+1})}if(h&&h[a.level]){if(1==h[a.level].visible||1==h[a.level].edit){var o;for(var p in a.rawNode)p.indexOf(".")<0&&(o=dm_Tools.prop2obj(a,p),h[a.level].edit&&null==o.edit&&(o.edit=h[a.level].edit),0!=o.visible&&"false"!=o.visible&&k({propObj:o,label:p,value:dm_Tools.convertValue(a.rawNode[p]),order:j.length+1}))}var q=null,r=h[a.level].children;if(h[a.level][h[a.level].name],r&&r.length>0&&(q=r),q)for(var s,t=q.length,u=0;t>u;u++){s=q[u];var o=dm_Tools.prop2obj(a,s.name);for(var v in s)o[v]||(o[v]=s[v]);"false"!=o.visible&&0!=o.visible&&(f&&1==s.dontExport||k({propObj:o,label:s.label||s.name,value:dm_Tools.convertValue(a.rawNode[s.name]),order:j.length+1}))}}l()}return j.sort(function(a,b){var c=0,d=a.propObj.order,e=b.propObj.order;return 0>d&&(d=j.length+100-a.propObj.order),0>e&&(e=j.length+100-b.propObj.order),void 0==d&&(d=a.order),void 0==e&&(e=b.order),void 0!=d&&void 0==e&&(c=d<j.length?-1:1),void 0!=e&&void 0==d&&(c=e<j.length?1:-1),void 0!=d&&void 0!=e&&(c=e>d?-1:1),c}),j.forEach(function(e){i=b(e.propObj,a,d,e.label,e.value),c+=i?i:""}),c},dm_Tools.cos=function(a){return Math.cos(a*Math.PI/180)},dm_Tools.sin=function(a){return Math.sin(a*Math.PI/180)},dm_Tools.circle=function(a,b,c,d,e,f,g,h){var i,j=1,k="",l=0;if(k+=g(c+e*dm_Tools.cos(a),d+e*dm_Tools.sin(a),h),l++,b-a>j)for(i=a+j,i=a+j;b>i;i+=j)k+=g(c+e*dm_Tools.cos(i),d+e*dm_Tools.sin(i),h),l++;return k+=g(c+e*dm_Tools.cos(b),d+e*dm_Tools.sin(b),h),l++,f[0]=l,k},dm_Tools.pie=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u=0,v=0,w=-90,x="",y=[2],z="";for(e-=h,n=c+e,o=d+e,u=0;u<f.length;u++)v+=f[u];for(r=360/v,u=0;u<f.length;u++){z="";var A;l&&(A=j(a,b,y,z,k,g[u],u,!0)),s=w+f[u]*r,t=w+(s-w)/2,p=n+h*dm_Tools.cos(t),q=o+h*dm_Tools.sin(t),z+=i(p,q,A),z+=dm_Tools.circle(w,s,p,q,e,y,i,A),z+=i(p,q,A),w=s,m&&(z=j(a,b,y,z,A,g[u],u,!1,!0)),x+=z}return x},dm_Tools.getParentNode4Config=function(a){var b,c=a;for(a||(a=dm_Datamap.currentDatamap.root);!b&&a;)b=a[dm_Tools_dm_config_name],c=a,a=a.parent;return c},dm_Tools.getConfig=function(a){var b,c=dm_Tools.getParentNode4Config(a);return c&&(b=c[dm_Tools_dm_config_name]),b||(b=dm_Tools.defaultConfig(),c&&(c[dm_Tools_dm_config_name]=b)),b},dm_Tools.getChildrenAtLevel=function(a,b){var c;if(!b||a.level<b)if(a.children)for(var d,e=a.children.length,f=0;e>f;f++){d=a.children[f];var g=dm_Tools.getChildrenAtLevel(d,b);if(g)if(c)for(var h,i=g.length,j=0;i>j;j++)h=g[j],c.push(h);else c=g}else b||(c=[],c.push(a));else a.level==b&&(c=[],c.push(a));return c},dm_Tools.formatXml=function(a){var b="",c=/(>)(<)(\/*)/g;a=a.replace(c,"$1\r\n$2$3");var d=0;return jQuery.each(a.split("\r\n"),function(a,c){var e=0;c.match(/.+<\/\w[^>]*>$/)?e=0:c.match(/^<\/\w/)?0!=d&&(d-=1):e=c.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var f="",g=0;d>g;g++)f+="  ";b+=f+c+"\r\n",d+=e}),b},dm_Tools.getColorInGradient=function(a,b,c){var d=parseInt(a.substring(1,3),16),e=parseInt(a.substring(3,5),16),f=parseInt(a.substring(5),16),g=parseInt(b.substring(1,3),16),h=parseInt(b.substring(3,5),16),i=parseInt(b.substring(5),16),j=Math.min(255,Math.round(d+(g-d)*c/100)),k=Math.min(255,Math.round(e+(h-e)*c/100)),l=Math.min(255,Math.round(f+(i-f)*c/100)),m=dm_Tools.hex2str(j);m.length<2&&(m="0"+m);var n=dm_Tools.hex2str(k);n.length<2&&(n="0"+n);var o=dm_Tools.hex2str(l);o.length<2&&(o="0"+o);var p="#"+m+n+o;return p},dm_Tools.getImageSrc=function(a,b){var c,d=a.imageName;return d.indexOf("data:image")<0&&(d="data/images/"+d),c=b?d||a.inlineSrc:a.inlineSrc||d},dm_Tools.getImageFromNode=function(a,b,c,d,e){var f,g,h,i=d?"_"+d:"",j=dm_Tools.getConfig(a);if(c)a.rawNode&&(f=a.rawNode[c+i],h=a.rawNode);else{var c="icon"+i;a.rawNode&&(h=a.rawNode,b?f=a.rawNode[c]:a.rawNode.image?(c="image"+i,f=a.rawNode[c]):f=a.rawNode[c])}if(!f&&h&&0!=h[c+".visible"]&&"false"!=h[c+".visible"]&&j&&j.styles&&j.styles.length>a.level&&(h=j.styles[a.level],c?f=h[c]:(c="image"+i,f=h[c],f||(c="icon"+i,f=h[c])),f&&(g=dm_Tools.prop2obj(h,c))),f){if(g||(g={},g=dm_Tools.prop2obj(a,c)),e){var k,l=f.lastIndexOf("/");l>0?k=f.substring(0,l+1):l=0,k+=e+"/",k+=f.substring(l+1),f=k}if(g.imageName=f,j&&j.styles&&j.styles[a.level]){var m=dm_Tools.prop2obj(j.styles[a.level],c);g.inlineSrc||(g.inlineSrc=m.inlineSrc),g.width||(g.width=m.width),g.height||(g.height=m.height),g.scaleFactor||(g.scaleFactor=m.scaleFactor),g.panelMaxHeight||(g.panelMaxHeight=m.panelMaxHeight),g.textX||(g.textX=m.textX),g.x||(g.x=m.x),g.y||(g.y=m.y)}}return g},dm_Tools.countNodes=function(a,b,c,d){var e=0,d=d||0;if(a&&(!c||a.children)&&(e=1,(!b||b>d)&&a.children))for(var f,g=a.children.length,h=0;g>h;h++)f=a.children[h],e+=dm_Tools.countNodes(f,b,c,d+1);return e},dm_Tools.random=function(a,b,c,d){var e=function(a){return Math.floor(Math.random()*Math.pow(10,a))},f=function(a,b){var c=e(a);if(b){for(var d=0;c>b&&d++<200;)c=e(a);c>b&&(c=b)}return c},g=(d||0)+f(a,c-(d||0));if(b)for(g=""+g;b&&g.length<a;)g="0"+g;return g},dm_Tools.trash,dm_Tools.randomString=function(a,b){for(var c="",d=b||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;a>e;e++)c+=d.charAt(Math.floor(Math.random()*d.length));return c},dm_Tools.distinct=function(a,b){var c;dm_Tools.trash||(dm_Tools.trash={}),dm_Tools.trash[b]||(dm_Tools.trash[b]={});for(var d=0;d++<1e3&&dm_Tools.trash[b][c=a()];);return d>=1e3&&console.log("Impossible to randomize a value for '"+b+"' different from : '"+c+"'"),dm_Tools.trash[b][c]=1,c},dm_Tools.getFirstLeaves=function(a,b,c){var d;if(a&&!a.children&&b>0&&c&&a.rawNode&&a.rawNode[c])d=[a];else if(a&&a.children&&b>0)for(var e,f=a.children.length,g=0;f>g;g++){e=a.children[g];var h=dm_Tools.getFirstLeaves(e,b,c);h&&(b-=h.length,d=d?d.concat(h):h)}return d},dm_Tools.hasParentWithName=function(a,b){return a&&a.name==b?a:a.parent?dm_Tools.hasParentWithName(a.parent,b):void 0},dm_Tools.html2rtf=function(a){if(!a)return a;a=a.replace(/[&]nbsp[;]/gi," ");var b=dm_Tools.html2dom(a),c=[!0],d=function(a){var b="",c=a.indexOf('style="text-align:');if(c>=0){var d=a.indexOf('"',c+7),e=a.substring(c+7,d);e.indexOf("center")>=0?b="\\qc ":e.indexOf("left")>=0?b="\\ql ":e.indexOf("right")>=0?b="\\qr ":e.indexOf("justify")>=0&&(b="\\qj ")}return b},e=function(){var a="\\par "+(c[0]?"\\pard ":"");return c[0]=!1,a},f=function(a){var b="",g="",h="";if(a)if("string"==typeof a)b+=a;else{if("u"==a.name)g+="{\\ul ",h+="}";else if("b"==a.name)g+="{\\b ",h+="}";else if("i"==a.name)g+="{\\i ",h+="}";else if("font"==a.name){var i=a.props.indexOf("size");if(i>=0){var j=a.props.indexOf('"',i),k=a.props.indexOf('"',j+1),l=a.props.substring(j+1,k);g+="{\\fs"+dm_Tools.rtfFontSize(l)+" ",h+="}"}}else if("ul"==a.name)g+="{\\ls1",h+="}";
else if("li"==a.name){var m=d(a.props);""!=m&&(g+=m,c[0]=!0);for(var n=0,o=a.parent;o&&"ul"==o.name;)n++,o=o.parent;n-=1;var p=dm_Rtf.rtfBulletStyles[n];g+="\\ls1 "+(n>0?"\\ilvl"+n+" ":"")+p+" ",h+=e()}else if("div"==a.name||"p"==a.name){g+=e();var m=d(a.props);""!=m&&(g+=m,c[0]=!0)}if(b+=g,a.children)for(var q,r=a.children.length,s=0;r>s;s++)q=a.children[s],b+=f(q);b+=h}return b};return f(b)},dm_Tools.removeAndReplaceDiv=function(a,b,c){var d,e=d3.select("#"+b);return e&&(d=e.style("height"),e.remove()),e=d3.select("#"+a).append("div").attr("id",b).attr("height","100%").style("height",d).style("max-height",d),c&&e.attr("class","modal-body"),e},dm_Tools.loadFromUrl=function(a,b){var c="xmlhttp";if("xmlhttp"==c){var d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=function(){4==d.readyState&&200==d.status&&b&&b(d.responseText)},d.open("GET",a,!0),d.setRequestHeader("Access-Control-Allow-Origin","*"),d.setRequestHeader("Access-Control-Allow-Headers","Cache-Control, Pragma, Origin, Authorization, Content-Type, X-Requested-With"),d.setRequestHeader("Access-Control-Allow-Methods","GET, PUT, POST"),d.send()}else if("iframe"==c){$("#fake_iframe_to_load_url_content_and_avoid_cross_domain_check").off("load");var e=d3.selectAll("body").append("iframe").attr("src",a).attr("id","fake_iframe_to_load_url_content_and_avoid_cross_domain_check").style("display","none").style("visibility","hidden").style("position","absolute").style("left","0px").style("top","0px").style("z-index","-1000").attr("height","0px").style("height","0px").on("load",function(){var a=e[0][0],b=a.contentWindow||a.contentDocument;b.document.body,console.log(d3.selectAll("#fake_iframe_to_load_url_content_and_avoid_cross_domain_check"))})}else"yql"==c&&jQuery.get(a,function(a){a&&a.responseText&&console.log(a.responseText)})},dm_Tools.defaultConfig=function(a,b){var c=90,d=0,e=0,f={root:null,styles:[{name:"root",level:d++,arrow:!0,arc:!1,rNod:10,link:c,color:dm_Tools.colors[e=0],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:10,link:c,color:dm_Tools.colors[e=0],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:9,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:9,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:9,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:8,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:8,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:7,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:7,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:6,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:6,link:c,color:dm_Tools.colors[e=0],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:5,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:5,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:5,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:5,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:4,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:4,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:4,link:c,color:dm_Tools.colors[++e],attrPaneCol:dm_Tools.colors[++e]},{name:"level "+d,level:d++,arrow:!0,arc:!1,rNod:4,link:c,color:dm_Tools.colors[e+=3],attrPaneCol:dm_Tools.colors[++e]},{name:"leaf",level:d++,arrow:!1,arc:!0,rNod:3,link:c/2,color:"#c7c7c7",attrPaneCol:"#c7c7c7",txtCol:"#7f7f7f"}],center:null,depth:6,setColumns2node:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],aggregate:null,displayProps:[{name:"root",children:[]},{name:"level "+(d=0),children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"level "+ ++d,children:[],edit:a,visible:b},{name:"leaf",children:[]}]};return f},dm_Tools.removePxAndParseInt=function(a){var b=null,a=a;if(a){var c=a.indexOf("px");c>=0&&(a=a.substring(0,c));try{b=parseInt(a)}catch(d){b=null}isNaN(b)&&(b=null)}return b},dm_Tools.loadLocalFile=function(a,b,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0),e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined"),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(c&&dm_Tools.saveFile(this.response,a,d?d:"text/plain","x-user-defined"),null!=b&&b(this))},e.send()},dm_Tools.positiveHex=function(a){if(0>a){for(var b=a.toString(16),c="",d=0;d<b.length-1;d++)c+="f";a=parseInt(c,16)+a+1}return a},dm_Tools.hex2str=function(a){return dm_Tools.positiveHex(a).toString(16)},dm_Tools.distBetween2points=function(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))},dm_Tools.arcCenter=function(a,b,c,d,e,f){var e=e||dm_Tools.distBetween2points(a,b,c,d),g=c-a>0?-1:1,h=2*Math.PI/3*(0==f?-1:1),i=Math.atan((d-b)/(c-a)),j=i+h;return{x:a+g*e*Math.cos(j),y:b+g*e*Math.sin(j)}},dm_Tools.circleIntersect=function(a,b,c,d,e,f){var g=d-a,h=e-b,i=Math.sqrt(g*g+h*h),j=(i*i+c*c-f*f)/(2*i),k=a+g*j/i+h/i*Math.sqrt(c*c-j*j),l=a+g*j/i-h/i*Math.sqrt(c*c-j*j),m=b+h*j/i-g/i*Math.sqrt(c*c-j*j),n=b+h*j/i+g/i*Math.sqrt(c*c-j*j);return{x1:k,y1:m,x2:l,y2:n}},dm_Tools.formatDuration=function(a,b,c,d){var e=function(a){var b="";return 10>a&&(b+="0"),b+=a},f=1e3,g=60*f,h=60*g,i=24*h,j=7*i,k=365*i,l=a,m=Math.floor(l/k);l-=m*k;var n=Math.floor(l/j);l-=n*j;var o=Math.floor(l/i);l-=o*i;var p=Math.floor(l/h);l-=p*h;var q=Math.floor(l/g);l-=q*g;var r=Math.floor(l/f);l-=r*f;var s=l,b=b||":",c=c||"-",t="";return t+=m>0?m+(d?"y ":c):"",t+=m>0?n+(d?"w ":c):n>0?n+(d?"w ":c):"",t+=m>0||n>0?o+(d?"d ":" "):o>0?o+(d?"d ":" "):"",t+=p>0?p+(d?"h ":b):"",t+=p>0?e(q)+(d?"mn ":b):q>0?q+(d?"mn ":b):"",t+=p>0||q>0?e(r)+(d&&0==s?"s":""):r>0||s>0?r+(d&&0==s?"s":""):"",s>0&&(t+="."+s+(d?"s":"")),t},dm_Tools.parseDuration=function(a,b){for(var c,d,e,f,g,h,i,b=b||":",j=(""+a).split(b),k=!1,l=1e3,m=60*l,n=60*m,o=24*n,p=7*o,q=365*o,r=j.length-1;r>=0;r--){var s;try{s=parseInt(j[r])}catch(t){}null!=s&&(k=!0,null==c?c=s:null==d?d=s:null==e?e=s:null==f?f=s:null==g?g=s:null==h&&(h=s))}return k&&(h=null!=h?h:0,g=null!=g?g:0,f=null!=f?f:0,e=null!=e?e:0,d=null!=d?d:0,c=null!=c?c:0,i=h*q+g*p+f*o+e*n+d*m+c*l),i},dm_Tools.getAllNodesFromNode=function(a){for(var b=a;b.parent;)b=b.parent;var c=[],d=function(a){if(c.push(a),a&&a.children)for(var b,e=a.children.length,f=0;e>f;f++)b=a.children[f],d(b)};return d(b),c},dm_Tools.testFileExist=function(a,b,c,d){var e,d=null!=d?d:!0;a.indexOf(".")>0&&(e=a.substring(a.lastIndexOf(".")+1)),$.ajax({type:"GET",url:a,success:function(){b&&b()},error:function(a){200==a.status&&"OK"==a.statusText&&"json"==e?b&&b():c&&c()},async:d})},dm_Tools.concat=function(a,b){if(a&&b)for(var c,d=b.length,e=0;d>e;e++)c=b[e],a.push(c);return a},dm_Tools.getSearchList=function(a,b,c,d){var b=b||dm_Tools.getParentNode4Config(a),e=dm_Tools.getConfig(a),f=e.props4globalSearch,c=c||" | ",d=d||{},g=function(a,b){var d;if(a&&(a.name&&(d||(d=""),d+=a.name),a.rawNode&&b))for(var e,f=b.length,g=0;f>g;g++)e=b[g],a.rawNode[e]&&(d?d+=c:d="",d+=a.rawNode[e]);return d&&(d=d.trim()),d},h=g(b,f);if(h&&(d[h]=b),b.children)for(var i,j=b.children.length,k=0;j>k;k++)i=b.children[k],dm_Tools.getSearchList(i,i,c,d);return d},dm_Tools.getConfigProp=function(a,b,c){if(b&&a){var d,e=dm_Tools.getParentNode4Config(b);e&&(d=e[dm_Tools_dm_config_name]);var f;return d&&(f=d[a]),null==f&&(f=dm_Tools.getConfigProp(a,e.parent||c)),null==f&&(f=dm_Tools.defaultConfig()[a]),f}},dm_Tools.getConfigPropInCascad=function(a,b){for(var c,d=a;d&&!c;)d=dm_Tools.getParentNode4Config(d),c=d[dm_Tools_dm_config_name][b],d=d.parent;return c||(c=dm_Tools.defaultConfig()[b]),c},dm_Tools.getGaugeFromNode=function(a,b){var c;if(a&&a.rawNode){var d="gauge_"+b;if(c=a.rawNode[d+".dm_props"],!c)for(var e in a.rawNode)if(e.indexOf(d)>=0){var f=e.substring(d.length+1);f&&""!=f&&(c||(c={}),c[f]=a.rawNode[e])}}return c&&(c=dm_Tools.deepCopy(c),c.scale||(c.scale=1),c.width||(c.width=30),c.height||(c.height=8),c.stroke||(c.stroke="#000000"),c["stroke-width"]||(c["stroke-width"]=1),c.backgrdOpacity||(c.backgrdOpacity=.8),c.x||(c.x=0),c.y=c.y?-c.y:0,c.colorMin||(c.colorMin="#FF4040"),c.colorMax||(c.colorMax="#98C237"),(!c.max||c.max<=0)&&(c.max=100),c.value&&(c.value<0&&(c.value=0),c.value>c.max&&(c.value=c.max))),c},dm_Tools.parseNumbersOfTree=function(a){var b=function(a){if(a.rawNode)for(prop in a.rawNode){var c=a.rawNode[prop];if(c=(""+c).replace(/,/g,"."),1==c&&(a.rawNode[prop]=1),0==c&&(a.rawNode[prop]=0),1!=c&&0!=c&&!isNaN(c)){try{value=parseFloat(c)}catch(d){try{value=parseInt(c)}catch(e){value=null}}null!=value&&(a.rawNode[prop]=value)}}if(a.children)for(var f,g=a.children.length,h=0;g>h;h++)f=a.children[h],f&&b(f)};a&&b(a)},dm_Tools.getDepth=function(a){for(var b=0,c=a;c.parent;)b++,c=c.parent;return b},dm_Tools.isParentOfEachOther=function(a,b){for(var c=!1,d=a,e=b;d&&!c;)c=d==b,d=d.parent;for(;e&&!c;)c=e==a,e=e.parent;return c},dm_Tools.isAlreadyConnected=function(a,b,c,d,e){var f=a==b,g=e?dm_Tools_aggregatedConnected:dm_Tools_connected;if(!f&&a&&a.rawNode[g+d])for(var h,i,j=a.rawNode[g+d],k=j.length-1;k>=0&&!f;k--)h=j[k],i=dm_Tools.getNodeFromPath(h.nodePath).node,f=i==b,h.name&&c&&(f=f&&h.name==c);return f},dm_Tools.flatClone=function(a){var b;if(a){b={};for(var c in a)b[c]=a[c]}return b},dm_Tools.completeBothSidesOfConnection=function(a,b){var c=a.rawNode[dm_Tools_connected+b];if(c)for(var d,e=c.length-1;e>=0;e--)if(d=c[e]){var f=dm_Tools.getNodeFromPath(d.nodePath).node;if(f){var g="From"==b?"To":"From";if(!dm_Tools.isAlreadyConnected(f,a,d.name,g,!1)){f.rawNode[dm_Tools_connected+g]||(f.rawNode[dm_Tools_connected+g]=[]);var h=dm_Tools.flatClone(d);h.nodePath=dm_Tools.getNodeUrl(a,!0,"noDatamapNameInURL",!0),f.rawNode[dm_Tools_connected+g].push(h)}f.rawNode[dm_Tools_connected+g+".dm_props"]||(f.rawNode[dm_Tools_connected+g+".dm_props"]={name:dm_Tools_connected+g,label:dm_Tools_connected+g,type:"transverse link",source:"user"})}}},dm_Tools.completeBothSidesOfConnections=function(a){if(a){if(a.children)for(var b,c=a.children.length-1;c>=0;c--)b=a.children[c],dm_Tools.completeBothSidesOfConnections(b);dm_Tools.completeBothSidesOfConnection(a,"To"),dm_Tools.completeBothSidesOfConnection(a,"From")}},dm_Tools.doAggregatedConnection=function(a,b,c,d,e){var f;return dm_Tools.isAlreadyConnected(a,b,c.name,d,!0)||(a.rawNode[dm_Tools_aggregatedConnected+d]||(a.rawNode[dm_Tools_aggregatedConnected+d]=[]),f=dm_Tools.flatClone(c),f.nodePath=dm_Tools.getNodeUrl(b,!0),e&&(f.originalConnection=e),a.rawNode[dm_Tools_aggregatedConnected+d].push(f)),f},dm_Tools.aggregateConnectionsBetweenParents=function(a,b,c,d){for(var e,f,g=a,h=b,i=dm_Tools.getDepth(g),j=dm_Tools.getDepth(h),k=function(){f=dm_Tools.doAggregatedConnection(g,h,c,d,e),e={source:"To"==d?g:h,target:"To"==d?h:g,connectionObj:f}};g&&i>j;)e||(e={source:"To"==d?g:h,target:"To"==d?h:g,connectionObj:c}),g=g.parent,i--,k();for(;h&&j>i;)e||(e={source:"To"==d?g:h,target:"To"==d?h:g,connectionObj:c}),h=h.parent,j--,k();for(;g&&h&&g!=h;)e||(e={source:"To"==d?g:h,target:"To"==d?h:g,connectionObj:c}),g=g.parent,i--,h=h.parent,j--,k()},dm_Tools.aggregateConnection=function(a,b){if(a&&a.rawNode){var c=a.rawNode[dm_Tools_connected+b];if(c)for(var d,e=c.length-1,f="From"==b?"To":"From";e>=0;e--)if(d=c[e]){var g=dm_Tools.getNodeFromPath(d.nodePath).node;g?(dm_Tools.aggregateConnectionsBetweenParents(a,g,d,b),dm_Tools.aggregateConnectionsBetweenParents(g,a,d,f)):"To"==b?console.log('Failed to connect "'+dm_Tools.getNodeUrl(a,!0)+'" to "'+d.nodePath+'" : target not found'):console.log('Failed to connect "'+d.nodePath+'" to "'+dm_Tools.getNodeUrl(a,!0)+'" : source not found')}}},dm_Tools.aggregateConnections=function(a){if(a){if(a.children)for(var b,c=a.children.length-1;c>=0;c--)b=a.children[c],dm_Tools.aggregateConnections(b);dm_Tools.aggregateConnection(a,"To"),dm_Tools.aggregateConnection(a,"From")}},dm_Tools.numberOfParents=function(a){var b=0;if(a)for(var c=a.parent;c;)b++,c=c.parent;return b},dm_Tools.defaultDiacriticsRemovalap=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],dm_Tools.diacriticsMap={},dm_Tools.createDiacriticsMap=function(){for(var a=0;a<dm_Tools.defaultDiacriticsRemovalap.length;a++)for(var b=dm_Tools.defaultDiacriticsRemovalap[a].letters.split(""),c=0;c<b.length;c++)dm_Tools.diacriticsMap[b[c]]=dm_Tools.defaultDiacriticsRemovalap[a].base},dm_Tools.createDiacriticsMap(),dm_Tools.removeDiacritics=function(a){function b(a){return dm_Tools.diacriticsMap[a]||a}if(a)return a.replace(/[^\u0000-\u007E]/g,b)},dm_Tools.formatJSVarName=function(a){if(!a)return console.log("Warning : giving null to dm_Tools.formatJSVarName"),void 0;var a=dm_Tools.removeDiacritics(a);return a=a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"_"),a=a.replace(/\ /g,"_")},dm_Tools.removeSpecialChars=function(a){var a=a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");return a},dm_Tools.writeHTMLCanvasTxt=function(a,b,c,d,e,f,g,h){f&&(a.strokeStyle=f,a.shadowColor=f,a.shadowBlur=h,a.lineWidth=g||3,a.strokeText(b,c,d)),a.fillStyle=e,a.fillText(b,c,d),a.shadowColor=null,a.shadowBlur=0},dm_Tools.getDefaultFontSize=function(a){var b=document.body,c=document.createElement("div");c.style.cssText="display:inline-block; padding:0; line-height:1; position:absolute; visibility:hidden; font-size:1em",c.appendChild(document.createTextNode(a)),b.appendChild(c);var d={w:c.offsetWidth,h:c.offsetHeight};return b.removeChild(c),d},dm_Tools.parseDate=function(a){var b=/(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})/,c=b.exec(a),d=new Date(+c[3],+c[2]-1,+c[1],+c[4],+c[5],+c[6]);return d},dm_Tools.removeCommentsCLike=function(a){return a.replace(/\/\*.+?\*\/|\/\/.*(?=[\n\r])/g,"")},dm_Tools.removeCommentsHash=function(a){return a.replace(/#.*(?=[\n\r])/g,"")},dm_Tools.decodeValue=function(a,b){if(output=a,"string"==typeof a&&b)try{output=decodeURIComponent(a)}catch(c){output=a}return output},dm_Tools.convertImgToBase64=function(a,b,c){var d=document.createElement("CANVAS"),e=d.getContext("2d"),f=new Image;f.crossOrigin="Anonymous",f.onload=function(){var a;d.height=f.height,d.width=f.width,e.drawImage(f,0,0),a=d.toDataURL(c),b.call(this,a),d=null},f.src=a},dm_Tools.arrayFromObj=function(a){var b=[];for(prop in a)b.push(prop);return b},dm_Tools.removeProps4nodes=function(a,b){for(var c,a=a,d=[a];d.length>0;)if(a=d.pop()){if("string"==typeof b)delete a[b];else for(c=b.length-1;c>=0;c--)delete a[b[c]];if(a.children)for(c=a.children.length-1;c>=0;c--)d.push(a.children[c])}},dm_Tools.setProps4nodes=function(a,b,c){for(var d,a=a,e=[a];e.length>0;)if(a=e.pop()){if("string"==typeof b)a[b]=c;else for(d=b.length-1;d>=0;d--)a[b[d]]=c[d];if(a.children)for(d=a.children.length-1;d>=0;d--)e.push(a.children[d])}},dm_Tools.updateLevels=function(a){for(var b,a=a,c=[a];c.length>0;)if(a=c.pop(),a&&(dm_Tools.bestEffortLevel(a),a.children))for(b=a.children.length-1;b>=0;b--)c.push(a.children[b])},dm_Tools.mergeAttributes=function(a,b){for(var c in b)("undefined"===a[c]||null===a[c])&&(a[c]=b[c])},dm_Tools.isChild=function(a,b){if(a&&a.children)for(var c,d=a.children.length-1;d>=0;d--)if(c=a.children[d],c.name==b)return c},dm_Tools.merge=function(a,b,c,d){var e=null;if(a&&b&&(c||a.name==b.name)){if(e=a,b.children){var f,g,h=b.children.length-1;for(a.children||(a.children=[]);h>=0;h--)f=b.children[h],g=dm_Tools.isChild(a,f.name),g?dm_Tools.merge(g,f):(f.parent=a,a.children.push(f),f[dm_Tools_dm_config_name]=d)}a.rawNode&&dm_Tools.mergeAttributes(a.rawNode,b.rawNode),dm_Tools.mergeAttributes(a,b)}return e},dm_Tools.noShow=function(){var a=d3.select("#temporary_and_hidden");return a[0][0]||(a=d3.select("body").append("noshow").attr("id","temporary_and_hidden").style("position","absolute").style("top","-100000px").style("left","-100000px").style("z-index",-1e3)),a},dm_Tools.resetNoShow=function(){dm_Tools.noShow().html("")},dm_Tools.getParentWithClass=function(a,b){return a?a.getAttribute("class")==b?a:dm_Tools.getParentWithClass(a.parentNode):void 0},dm_Tools.isInModal=function(a){return $(a[0][0]).parents(".modal")[0]},dm_Tools.isInTooltip=function(a){return $(a[0][0]).parents(".popover")[0]},dm_Tools.tintImage=function(a,b,c,d){var e=dm_Tools.color2rgb(b),f=dm_Tools.noShow();f.selectAll("#dm_Tools_tintImage").remove();var g=f.append("canvas").attr("id","dm_Tools_tintImage")[0][0];g.width=a.offsetWidth||a.width,g.height=a.offsetHeight||a.height,(g.width<=0||g.height<=0)&&console.log("Warning: "+d+" has 0 width:"+g.width+" or height:"+g.height);var h=g.getContext("2d");h.drawImage(a,0,0);for(var i,j,k,l,m=h.getImageData(0,0,g.width,g.height),n=m.data,o=0,p=n.length;p>o;o+=4)i=n[o],j=n[o+1],k=n[o+2],l=Math.floor((i+j+k)/3),i=l+(e.r-127.5)*c/100,j=l+(e.g-127.5)*c/100,k=l+(e.b-127.5)*c/100,n[o]=Math.min(255,Math.max(i,0)),n[o+1]=Math.min(255,Math.max(j,0)),n[o+2]=Math.min(255,Math.max(k,0));return h.putImageData(m,0,0),h.globalCompositeOperation="lighter",h.globalAlpha=0,h.fillRect(0,0,g.width,g.height),a.src=g.toDataURL(),a},dm_Tools.tintImageSrc=function(a,b,c,d){var e=dm_Tools.noShow();e.selectAll("#dm_Tools_tintImageSrc").remove();var f=dm_Tools.noShow().append("img").attr("id","dm_Tools_tintImageSrc").attr("src",a);f.on("load",null),f.on("load",function(){d3.select(this).on("load",null);var e=dm_Tools.tintImage(this,b,c,a);d&&d(e.src,e)})},dm_Tools.getImageSize=function(a,b,c,d){var e=dm_Tools.noShow();e.selectAll("#dm_Tools_getImageSizeImg").remove();var f=dm_Tools.noShow().append("img").attr("id","dm_Tools_getImageSizeImg").attr("src",a);f.on("load",null).on("error",null),f.on("load",function(){d3.select(this).on("load",null);var e=this.offsetWidth||this.width,f=this.offsetHeight||this.height;if(!c){var g=dm_Tools.noShow();g.selectAll("#dm_Tools_getImageSizeCanvas").remove();var h=g.append("canvas").attr("id","dm_Tools_getImageSizeCanvas")[0][0],i=1;d&&(i=e-d>f-d?d/e:d/f),h.width=e*i,h.height=f*i,(0==h.width||0==h.height)&&console.log("Warning: "+a+" has 0 width:"+h.width+" or height:"+h.height);var j=h.getContext("2d");j.drawImage(this,0,0),this.src=h.toDataURL()}b&&b(e,f,this)}).on("error",function(){b&&b(-1,-1,null)})},dm_Tools.inlineAndUpdateSizeOfAllImages=function(a,b,c){var d=[];dm_Tools.scanAllProps(a,function(a,b){if("icon"==b||"image"==b||a[b+".dm_props"]&&"image"==a[b+".dm_props"].type){var c=(a[b+".dm_props"]?a[b+".dm_props"].inlineSrc:null)||a[b]||(a[b+".dm_props"]?a[b+".dm_props"].imageName:null);d.push({parentObj:a,prop:b,imgSrc:c})}});var e=function(){var a=d.pop();if(a){var f=a.imgSrc;dm_Tools.getImageSize("data/images/"+f,function(c,d,g){if(g){a.parentObj[a.prop+".dm_props"]||(a.parentObj[a.prop+".dm_props"]={});var h=a.parentObj[a.prop+".dm_props"];h.type="image",h.imageName=f,h.width=c,h.height=d,b||(h.inlineSrc=g.src)}e()},b,c)}else console.log("after dm_Tools.inlineAndUpdateSizeOfAllImages",dm_Tools.getDelay("inlineAndUpdateSizeOfAllImages"))};e()},dm_Tools.getStyleSheets=function(){for(var a=[],b=0;b<document.styleSheets.length;b++){var c=document.styleSheets[b].href;c&&a.indexOf(c)<0&&a.push(c)}return a},dm_Tools.getIFrame=function(a,b,c,d,e){var f=a.append("iframe").attr("width",c?c+"px":"100%").attr("height",d?d+"px":"100%").style("border","none").style("scrolling","no").style("allowTransparency","true");return setTimeout(function(){for(var a=f[0][0].contentWindow||f[0][0].contentDocument,c=a.document,d=c.body,g=c.getElementsByTagName("head")[0],h=document.getElementsByTagName("style"),i=0;i<h.length;i++)g.appendChild(h[i].cloneNode(!0));var j=dm_Tools.getStyleSheets();if(j.forEach(function(a){var b=c.createElement("link");b.rel="stylesheet",b.type="text/css",b.href=a,d.appendChild(b)}),d3.select(d).style("background-color","transparent"),b){var k=d3.select(d).append("div").attr("align","center").append("table").attr("height","100%").append("tr").append("td").style("vertical-align","middle");k[0][0].appendChild(b[0][0])}e&&e(a)},10),f},dm_Tools.is3DgraphInAttributes=function(a){if(a.rawNode)for(var b in a.rawNode){var c=a.rawNode[b+".dm_props"];if(c&&"graph"==c.type&&c["3D"])return!0;var d=b.lastIndexOf(".3D");if(d>0&&a.rawNode[b]){var e=b.substring(0,d);if("graph"==a.rawNode[e+".type"])return!0}}},dm_Tools.getMinimumPath=function(a,b){var c=dm_Tools.getParentNode4Config(a),d=dm_Tools.getParentNode4Config(b),e=dm_Tools.getNodeUrl(c,!0,"noDatamapNameInURL"),f=dm_Tools.getNodeUrl(d,!0,"noDatamapNameInURL"),g=dm_Tools.getNodeUrl(b,!0,"noDatamapNameInURL");if(0==f.indexOf(e)){var h=e.lastIndexOf("|");h>=0&&(g=g.substring(h+1))}return g},dm_Tools.areNodePathEqual=function(a,b){var c=dm_Tools.getNodeUrl(b,!0,"noDatamapNameInURL",!0);return a==c?!0:(c=dm_Tools.getNodeUrl(b,!0,"noDatamapNameInURL"),a==c?!0:(c=dm_Tools.getNodeUrl(b,!0),a==c?!0:!1))},dm_Tools.getAllNodes=function(a,b){var b=b||[];if(b.push(a),a.children)for(var c,d=a.children.length-1;d>=0;d--)c=a.children[d],dm_Tools.getAllNodes(c,b);return b},dm_Tools.validateNodeWithStickerAndGauge=function(a,b,c){var d=[],c=c||1,e=function(a){a.rawNode["icon_"+c]="../../images/success_stamp.png",a.rawNode["icon_"+c+".dm_props"]={width:152,height:148,scaleFactor:7,imageName:"../../images/success_stamp.png"}},f=function(a){var g=function(a){if(a&&a.rawNode){var b=0,d=dm_Tools.getAllNodes(a),e=d.length;if(a.children?d.forEach(function(a){a&&a.rawNode&&a.rawNode["icon_"+c]&&b++}):a.rawNode["icon_"+c]&&(b=1),a.rawNode.nbOfValidatedNodes=b,b>0)a.rawNode["gauge_"+c+".dm_props"]={value:b,max:e,y:-21};else for(var f in a.rawNode)0==f.indexOf("gauge_"+c)&&delete a.rawNode[f]}a.parent&&!a.dm_config&&g(a.parent)};if(a&&a.rawNode){var h=!1;if(a.children){h=!0;for(var i,j=dm_Tools.getAllNodes(a),k=0;k<j.length&&h;k++)i=j[k],i.rawNode&&!i.rawNode["icon_"+c]&&(h=!1)}else h=!0;if(g(a),h){e(a);var l=function(a){var b=!1;return d.forEach(function(c){b||a!=c||(b=!0)}),b};d.push(a),a.rawNode&&a.rawNode.copyOf&&b.forEach(function(b){b&&b.rawNode&&b.rawNode.uid==a.rawNode.copyOf&&(l(b)||f(b))}),b.forEach(function(b){b&&b.rawNode&&b.rawNode.copyOf&&b.rawNode.copyOf==a.rawNode.uid&&(l(b)||f(b))}),f(a.parent)}}};e(a),f(a),dm_Datamap.currentDatamap.graph.init(null,"dont change node coords")},dm_Tools.iterOverObjProps=function(a,b,c){var d=dm_Tools.isArray(a),e=d?[]:{},f=0,c=c||{stopLoop:!1};if(d)for(f=0;f<a.length&&(e.push(b(a[f],f,f,a,c)),!c.stopLoop);f++);else for(var g in a)if(e[g]=b(a[g],g,f++,a,c),c.stopLoop)break;return e},dm_Tools.iterOverTable=function(a,b){return dm_Tools.iterOverObjProps(a,function(a,c,d,e,f){return dm_Tools.iterOverObjProps(a,b,f)})},dm_Tools.visitTree=function(a,b){if(a&&a.rawNode&&dm_Tools.iterOverObjProps(a.rawNode,b),a.children)for(var c=0;c<a.children.length;c++)dm_Tools.visitTree(a.children[c],b)},dm_Tools.iterOverColumn=function(a,b,c){return dm_Tools.iterOverObjProps(a,function(a,d,e,f,g){return c(a[b],e,a,g)})},dm_Tools.convertColumnsTreeIntoArray=function(a){var b=a;if(null!=a)if(dm_Tools.isArray(a)){b=[];for(var c=0;c<a.length;c++)b.push(dm_Tools.convertColumnsTreeIntoArray(a[c]))}else a&&a.name?b=a.name:a&&a.children&&(b=dm_Tools.convertColumnsTreeIntoArray(a.children));else b=Number(null);return b},dm_Tools.areObjEqual=function(a,b){var c=dm_Tools.deepCopy(a,"__dm_uniqueId"),d=dm_Tools.deepCopy(b,"__dm_uniqueId"),e=JSON.stringify(c),f=JSON.stringify(d);return e==f},dm_Tools.removeNodeProps=function(a,b,c){if(a){if(b.indexOf(a.name)>=0)for(var d in a)c.indexOf(d)<0&&delete a[d];if(a.children)for(var e,f=0;f<a.children.length;f++)e=a.children[f],dm_Tools.removeNodeProps(e,b,c)}},dm_Tools.equalsOrRexgexpMatch=function(a,b){var c=a==b;if(!c){var d=new RegExp(a);c=d.test(b)}return c},dm_Tools.sortChildrenByPos=function(a){if(a&&a.children&&a.children.length>0){for(var b,c,d,e,f=a.x,g=a.y,h=a.children.length-1,i=[];h>=0;h--)b=a.children[h],c=b.x-f,d=-(b.y-g),e=Math.PI/2-Math.atan(d/c)+(0>c?Math.PI:0),i.push({elt:b,ang:e});i.sort(function(a,b){return a.ang==b.ang?0:a.ang>b.ang?1:-1}),a.children=[];for(var j=0;j<i.length;j++)b=i[j].elt,b.rawNode&&b.rawNode.hasOwnProperty("array index")&&(b.rawNode["array index"]=j),a.children.push(b)}},dm_Tools.isEltEqualsSelector=function(a,b){return"#"==b[0]?$(a).attr("id")==b.substring(1):"."==b[0]?$(a).hasClass(b.substring(1).toLowerCase()):a.nodeName.toUpperCase()==b.toUpperCase()},dm_Tools.isEqualOrParents=function(a,b){var c=dm_Tools.isEltEqualsSelector(a,b),d=$(a).parent()[0];return!c&&d&&(c=dm_Tools.isEqualOrParents(d,b)),c},dm_Tools.isEventCoordsIn=function(a,b){var c=!1;if(b){var d=b.getBoundingClientRect();c=a.pageX>=d.left&&a.pageX<=d.left+d.width&&a.pageY>=d.top&&a.pageY<=d.top+d.height}return c},dm_Csv.removeEmptyColumns=function(a){for(var b,c=a.length-1;c>=0;c--)b=a[c],b&&""!=b||a.splice(c,1)},dm_Csv.extension="csv",dm_Csv.nodeI=0,dm_Csv.nodeJ=0,dm_Csv.dontExportProps=["__dm_uniqueId","dm_uniqueId","icon","order","dm_goto","dm_goto_config","dm_sourceFile","connectedTo","connectedFrom","aggregatedConnectedTo","aggregatedConnectedFrom"],dm_Csv.isPropExportable=function(a,b){if(!b||""==b)return!1;for(var c=!0,d=dm_Csv.dontExportProps.length-1;d>=0&&c;d--)dm_Csv.dontExportProps[d]==b&&(c=!1);c&&(b.indexOf(".dm_props")>=0||b.indexOf(".")>=0)&&(c=!1);var e;return c&&a[b]&&(e=a[""+b+".dm_props"],e&&null!=e.dontExport?c=e.dontExport:null!=a[""+b+".dontExport"]&&(c=a[""+b+".dontExport"])),c&&e&&"boolean"!=e.type&&"image"!=e.type&&"javascript"!=e.type&&"rich text"!=e.type&&"text"!=e.type&&(c=!1),c},dm_Csv.getValue=function(a,b){if(a&&dm_Csv.isPropExportable(a,b)){var c=a[b];return c}},dm_Csv.enrichColumnsOnTheFly=function(a,b){for(var c in a)dm_Csv.isPropExportable(a,c)&&!b[c]&&(b[c]=null)},dm_Csv.node2csv=function(a,b,c,d,e,f,g,h,i){var j="",k=h?[]:{},l={};dm_Csv.node2csvValues(a,b,c,null,e,f,g,k,l,null,h,i);var m="",n=0==c.csvSepIsSemicolon?",":";",c=c||dm_Tools.getConfig(a),o=null,p=!1,q=null;for(var r in l)m+=0==r.indexOf("dm_hoTable_level_")?"level "+r.substring("dm_hoTable_level_".length)+n:r+n;j=m+"\n"+j;var s=function(){p=!0;for(var a in l)p||(j+=n),p=!1,q=o[a],j+=q?q:"";j+="\n"};if(h)for(var t=0;t<k.length;t++)o=k[t],s();else for(var u in k)o=k[u],s();return j},dm_Csv.node2table=function(a,b,c){var d=b?[]:{};return console.time("node2csv"),dm_Csv.node2csvValues(a,null,null,null,null,null,null,d,c,null,b,!0),console.timeEnd("node2csv"),d},dm_Csv.cloneAndConvertRichText2flatText=function(a){var b=dm_Tools.getConfig(a),a=dm_Tools.deepCopy(a,"parent");return dm_Tools.restoreParentsInTree(a),dm_Tools.visitTree(a,function(a,c,d,e){"string"==typeof a&&((e[c+".dm_props"]&&"rich text"==e[c+".dm_props"].type||"rich text"==e[c+".type"])&&(a=jQuery(a).text()),a=0==b.csvSepIsSemicolon?a.replace(/,/g,";"):a.replace(/;/g,","),a=a.replace(/\n/g," "),a=a.replace(/\r/g,""),e[c]=a)}),a},dm_Csv.node2csvValues=function(a,b,c,d,e,f,g,h,i,j,k,l){dm_Csv.nodeI++,dm_Csv.nodeJ++,dm_Csv.nodeJ>f&&(dm_Csv.nodeJ=0,null!=g&&g(dm_Csv.nodeI));var e=e||0;c=c||dm_Tools.getConfig(a),b||0===b||(b=dm_Tools.getMaxDepth(a));var m=c.columnNames;j=j||!m;var h=h||(k?[]:{});if(b>=e){if(m){i||(i={});for(var n=0;n<m.length;n++)i[""+m[n]]=null}if((!i||0==Object.keys(i).length)&&(i||(i={}),l))for(var n=0;b>=n;n++)i["dm_hoTable_level_"+n]=null;if(dm_Csv.enrichColumnsOnTheFly(a.rawNode,i),a.rawNode||(a.rawNode={}),k?h.push(a.rawNode):h[""+Object.keys(h).length]=a.rawNode,l)for(var o=dm_Tools.getNodePathNames(a),n=0;b>=n;n++)n<o.length&&(a.rawNode["dm_hoTable_level_"+n]=o[n]);if(a.children)for(var p,q=a.children.length,n=0;q>n;n++)p=a.children[n],dm_Csv.node2csvValues(p,b,c,d,e+1,f,g,h,i,j,k,l)}},dm_Csv.getColumnValuesFromTable=function(a,b){for(var c,d,e,f={},g=0;g<a.length;g++)if(c=a[g])if(dm_Tools.isArray(b))for(var h=0;h<b.length;h++)e=b[h],f[e]||(f[e]=[]),dm_Tools.isArray(c)?(d=c[h],d&&f[e].indexOf(d)<0&&f[e].push(d)):(d=c[e],d&&f[e].indexOf(d)<0&&f[e].push(d));else for(var i in b)if(f[i]||(f[i]=[]),dm_Tools.isArray(c)){var h=Object.keys(b).indexOf(i);
d=c[h],d&&f[i].indexOf(d)<0&&f[i].push(d)}else d=c[i],d&&f[i].indexOf(d)<0&&f[i].push(d);return f},dm_LDIF.extension="ldif",dm_LDIF.parse=function(a,b){this.nodes=new dm_tools_NameIdList,this.root=b.parentNode||{name:b.name,id:dm_Tools.getId(),rawNode:{discardNodeAfterPaste:!0}},this.columnNames={};var c=this,d=function(){b.data=[];for(var c,d,e,f,g,h,i,j,k,l,m=a.split(/\r?\n\r?\n/g),n=function(){h&&(d||(d={},k={}),l=k[h],k[h]=null!=l?++l:0,d[h+(l>0?"."+l:"")]=j)},o=0;o<m.length;o++){if(c=m[o],e=c.split(/\r?\n/g),e.length>0){h=null,j="",d=null,k=null;for(var p=0;p<e.length;p++)f=e[p],f.trim().indexOf("#")<0&&(f=dm_Tools.removeCommentsHash(f)," "!=f[0]&&"	"!=f[0]?(h&&(n(),j=null),g=f.indexOf(":"),g>0&&(h=f.substring(0,g),h=h.trim())):g=-1,i=f.substring(g+1),i&&(j||(j=""),j+=i.trim()));n()}d&&b.data.push(d)}},e=function(a,b){if(a&&a.children)for(var c,d=0;d<a.children.length;d++)if(c=a.children[d],c.name==b)return c},f=function(a,b,d){if(!a)return console.log("found an object without 'dn:' field."),console.log(dm_Tools.stringify(b)),void 0;for(var f,h,i=a.length-1,k=c.root;i>=0;i--)f=a[i],h=e(k,f),d[i-1],h?0==i&&g(h,b,d[i-1]):(h=j(k,f,0==i?b:null,d[i-1]),k.children||(k.children=[]),k.children.push(h)),k=h;return k},g=function(a,d,e){"l"==e?a.level=b.config.styles.length-2:"st"==e&&(a.level=b.config.styles.length-3);var f;for(var g in d)f=d[g],f&&0==f.indexOf(": ")&&(f=f.substring(2)),a.rawNode[g]=f,"uid"==g&&f&&b.config&&b.config.styles&&(a.level=b.config.styles.length-1),h(a,g),c.columnNames[g]||(c.columnNames[g]=1),a.rawNode[g+".visible"]=!0,a.rawNode[g+".edit"]=!0},h=function(a,c){var d=!0;if(b.config.props2query&&b.config.props2query.length>0&&(d=!1,b.config.props2query.indexOf(c)>=0&&(d=!0)),b.config.notProps2query&&b.config.notProps2query.length>0&&b.config.notProps2query.indexOf(c)>=0&&(d=!1),d){b.props2query||(b.props2query={}),b.props2query[c]||(b.props2query[c]={});var e=a.rawNode[c];e&&!b.props2query[c][e]&&(b.props2query[c][e]=1)}},i=function(){var a;for(a in b.props2query)b.props2query[a]=dm_Tools.arrayFromObj(b.props2query[a])},j=function(a,b,d,e){var f={parent:a,name:b,rawNode:{}};return g(f,d,e),c.nodes.addObject(f),f},k=function(a){for(var b,c,d=a.split(","),e=0;e<d.length;e++){c=d[e];var f=c.split("=")[1];f&&(f=f.trim(),b||(b=[]),b.push(f))}return b},l=function(){for(var a,c,d,e,g,h=0;h<b.data.length;h++){if(g={},a=b.data[h],d=[],a.dn&&(d=k(a.dn)),g=[],b.config.attributes2tree)for(var i,j=0;j<b.config.attributes2tree.length;j++)i=b.config.attributes2tree[j],e=a[i],e&&(g.splice(0,0,i),d&&d.splice(1,0,e));c=f(d,a,g)}};console.log("start generating the tree "+dm_Tools.getDelay()),d(),l(),b.root=c.root,b.setNodes(c.nodes),i(),b.config.columnNames=dm_Tools.arrayFromObj(c.columnNames),console.log("finished doing the tree "+dm_Tools.getDelay())},dm_LDIF.node2ldif=function(a,b,c,d,e,f,g){var h="",i={},j={};dm_Csv.node2csvValues(a,b,c,null,e,f,g,i,j,null,null,!0);var k,l=null,m=null,n=function(){for(var a in j)k=a,0==a.indexOf("dm_hoTable_level_")&&(k=""+a.substring("dm_hoTable_".length)),m=l[a],m&&(h+=dm_Tools.formatJSVarName(k)+": "+m+"\n");h+="\n"};for(var o in i)l=i[o],n(),h+="\n\n";return h},dm_Freemind.mmOpenNode=function(a,b,c,d){return b=b||!1,c=c||!1,a=dm_Freemind.mmFormatText(a),'<node TEXT="'+a+'" FOLDED="'+b+'" '+(d?'COLOR="'+d+'" ':"")+'STYLE="'+(c?"bubble":"fork")+'">\n'},dm_Freemind.mmFormatText=function(a){return a=""+a,a=a.replace(/&/g,"+"),a=a.replace(/"/g,"'")},dm_Freemind.mmCloseNode=function(){return"</node>\n"},dm_Freemind.nodeI=0,dm_Freemind.nodeJ=0,dm_Freemind.node2mm=function(a,b,c,d,e,f,g,h){if(dm_Freemind.nodeI++,dm_Freemind.nodeJ++,dm_Freemind.nodeJ>g&&(dm_Freemind.nodeJ=0,null!=h&&h(dm_Freemind.nodeI)),dm_Tools.isAdminConfigTreeNode(a))return"";var i=function(a,b,c,d,e){var f="";return a.graph||"rich text"==a.type||"image"==a.type||"action"==a.type||"music"==a.type||(null==e||""==e)&&a.dontDisplayNull||(f+=dm_Freemind.mmOpenNode(d,!1),f+=dm_Freemind.mmOpenNode(e,!1),f+=dm_Freemind.mmCloseNode(),f+=dm_Freemind.mmCloseNode()),f},b=b||0,j="",k=b>0;if(e>=b&&(a.children||!f))if("number"==typeof a||"string"==typeof a)j+=dm_Freemind.mmOpenNode(dm_Tools.convertValue(a),k),j+=dm_Freemind.mmCloseNode();else{if(j+=dm_Freemind.mmOpenNode(a.name,k,a.children?!0:!1,d(a)),j=dm_Tools.onDisplayableRawNodeProps(a,i,j,null,!0,!0,c),a.children)for(var l=0;l<a.children.length;l++)j+=dm_Freemind.node2mm(a.children[l],b+1,c,d,e,f,g,h);j+=dm_Freemind.mmCloseNode()}return j},dm_Json2tree.reservedProps=["id","name","parent","children","style","rawNode","children","dm_children","dm_DatamapName","level","x","y","px","py","weight","index","fixed","selected","dm_config","__dm_uniqueId","dm_uniqueId","$circularRefs"],dm_Json2tree.dontExportProps=["style","dm_children","x","y","px","py","weight","index","fixed","selected","repulseX","repulseY"],dm_Json2tree.obj2tree=function(a,b,c,d,e){var f,g=function(a){return!(dm_Tools.isArray(a)||"number"==typeof a||"string"==typeof a||"boolean"==typeof a)},h=function(a,d,e,f){if(a||(a={parent:null}),dm_Tools.isArray(e)){a.children||(a.children=[]);var i=a;d&&"children"!=d&&(i={name:d,parent:a,children:[]},a.children.push(i));for(var j=0;j<e.length;j++)if(arrayElt=e[j],null!=arrayElt){var k;g(arrayElt)?k=i:(k={parent:i},i.children.push(k)),h(k,null,arrayElt,j)}}else if(null==e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e)d?(a.rawNode||(a.rawNode={}),a.rawNode[d]=e,b&&(a.rawNode[d+".dm_props"]||(a.rawNode[d+".dm_props"]={}),a.rawNode[d+".dm_props"].visible=!0),c&&(a.rawNode[d+".dm_props"]||(a.rawNode[d+".dm_props"]={}),a.rawNode[d+".dm_props"].editable=!0)):a.name=e;else if(d&&d.indexOf(".dm_props")>=0)a[d]=e;else{a.children||(a.children=[]);var i={name:d,parent:a};isNaN(f)||(i.rawNode||(i.rawNode={}),i.rawNode["array index"]=f),a.children.push(i),e.children&&(i.children=e.children),e.rawNode&&(i.rawNode=e.rawNode);for(var l in e)"name"==l?d||(i.name=e[l]):"parent"!=l&&"children"!=l&&"rawNode"!=l&&h(i,l,e[l],f)}return a};return d?f=h(d,e,a):(f=h(null,a.name,a),g(a)&&(f=f.children[0],f.parent=null)),f},dm_Json2tree.tree2obj=function(a,b){var c,d,e=function(a,b){var c;return a.children&&a.children.length>0&&a.children.forEach(function(a){var d=dm_Json2tree.tree2obj(a,b);c||(c=[]),c.push(d)}),c};if(a.rawNode){var f=!1;for(var g in a.rawNode)0==g.indexOf("dm_hoTable_level_")?delete a.rawNode[g]:"dm_uniqueId"!=g&&(f=!0);f||delete a.rawNode}if(!a.rawNode&&a.name&&b)d=e(a,c),d?b[a.name]=d:a.name&&(c||(c={}),c.name=a.name);else{a.name&&(c||(c={}),c.name=a.name);for(var h in a.rawNode)c||(c={}),c[h]=a.rawNode[h];d=e(a,c),d&&(c||(c={}),c.children=d)}return c},dm_Json2tree.tree2realObjNotChildren=function(a){var b={};if(a.name&&(b.name=a.name,a.rawNode||a.children||(b=dm_BeforeAll.parseAtomic(a.name))),a.rawNode)for(var c in a.rawNode)b[c]=a.rawNode[c];if(a.children){var d,e;a.children.forEach(function(c){!c.rawNode&&c.children?(e=dm_Json2tree.tree2realObjNotChildren(c),e&&(b[c.name]=e[c.name]?e[c.name]:[])):(d||(d=b[a.name||"children"]=[]),e=dm_Json2tree.tree2realObjNotChildren(c),d.push(e))})}return b},dm_Json2tree.node2json=function(a,b,c,d,e,f,g,h,i){var j=[];i||(j=dm_Json2tree.dontExportProps),c&&c.length>0&&(j=j.concat(c));var k=dm_Tools.cloneAndFixCircularRefs(a,j);h(33);var l=JSON.stringify(k);return h(99),l=dm_Tools.changeNewLinesFromJSONStrings(l,"re-set new-lines!")},dm_AggregationWorker_workerListener=function(e){var data=e.data;switch(data.cmd){case"aggregate":self.postMessage({admin:"aggregListener: start aggregation work: "+data.cmd});var aggregCodeParts=dm_Tools.parseStringified(data.aggregCodeParts),progressBarUpdates=200,bulkLength=aggregCodeParts.length>progressBarUpdates?Math.floor(aggregCodeParts.length/progressBarUpdates):1,j=1,bulkOfCodeParts="",root=dm_Tools.parseStringified(data.root);dm_Tools.restoreParentsInTree(root);for(var nodes=dm_Tools.getNodesFromRoot(root),i=0;i<aggregCodeParts.length;i++)if(bulkOfCodeParts+=aggregCodeParts[i],j==bulkLength){try{eval(data.aggregDeclaration+"\n"+bulkOfCodeParts)}catch(error){console.log("ERROR during eval of aggregation !\n"+error.stack);try{var info=error.stack.split("<anonymous>:")[1].split(":"),line=info[0],col=info[1].split(")")[0];console.log("line : "+line+", col : "+col);var linesOfCode=(data.aggregDeclaration+"\n"+bulkOfCodeParts).split("\n");line=parseInt(line),console.log("  --> "+linesOfCode[line])}catch(err){}}bulkOfCodeParts="",j=1,self.postMessage({percent:100*(i/aggregCodeParts.length)})}else j++;bulkOfCodeParts&&""!=bulkOfCodeParts&&eval(data.aggregDeclaration+"\n"+bulkOfCodeParts),self.postMessage({admin:"aggregListener: removeEventListener aggregListener"}),self.removeEventListener("message",dm_AggregationWorker_workerListener,!1),dm_Tools.removeProps4nodes(root,"parent");var clonedRootWithRefs=dm_Tools.stringify(root);self.postMessage({percent:100,root:clonedRootWithRefs});break;case"save":self.postMessage({admin:"saveListener: start save work: "+data.cmd});var root=dm_Tools.parseStringified(data.root);dm_Tools.restoreParentsInTree(root);var localConfig=data.config?dm_Tools.parseStringified(data.config):null,nbOfNodes=dm_Tools.countNodes(root,data.maxDepth,data.noLeafInReport),fileFormat=data.fileFormat,updateProgress=function(a){var b=100*(a/nbOfNodes);100>b&&self.postMessage({percent:b,admin:"saving "+fileFormat+" "+b+" %, node number: "+a})},updatePercent=function(a){100>a&&self.postMessage({percent:a,admin:"saving "+fileFormat+" "+a+" %"})},nbOfNodesPerBulk=nbOfNodes/100,file2saveContent=0,getColorFromNode=function(a){var b=localConfig.styles[a.level].txtCol||localConfig.styles[a.level].color;return b};if("mm"==fileFormat)self.postMessage({admin:"saving "+fileFormat+" "+nbOfNodes+" nodes, "+nbOfNodesPerBulk+" nodesPerBulk"}),dm_Freemind.nodeI=0,dm_Freemind.nodeJ=0,file2saveContent=dm_Freemind.node2mm(root,0,localConfig,getColorFromNode,data.maxDepth,data.noLeafInReport,nbOfNodesPerBulk,updateProgress);else if("csv"==fileFormat)self.postMessage({admin:"saving "+fileFormat+" "+nbOfNodes+" nodes, "+nbOfNodesPerBulk+" nodesPerBulk"}),dm_Csv.nodeI=0,dm_Csv.nodeJ=0,file2saveContent=dm_Csv.node2csv(root,data.maxDepth,localConfig,null,null,nbOfNodesPerBulk,updateProgress,!0,!0);else if("ldif"==fileFormat)self.postMessage({admin:"saving "+fileFormat+" "+nbOfNodes+" nodes, "+nbOfNodesPerBulk+" nodesPerBulk"}),dm_LDIF.nodeI=0,dm_LDIF.nodeJ=0,file2saveContent=dm_LDIF.node2ldif(root,data.maxDepth,localConfig,null,null,nbOfNodesPerBulk,updateProgress);else if("json"==fileFormat){self.postMessage({admin:"saving "+fileFormat+" "+nbOfNodes+" nodes, "+nbOfNodesPerBulk+" nodesPerBulk"});var data=dm_Json2tree.node2json(root,root.depth,null,null,data.maxDepth,data.noLeafInReport,!0,updatePercent);file2saveContent='{\n    "$schema": "http://www.freedatamap.com/jsonSchema/schema#",\n    "$circularRefs": true,\n    "root":'+data+"\n}"}else if("config"==fileFormat){self.postMessage({admin:"saving "+fileFormat});var data=dm_Json2tree.node2json(localConfig,null,null,null,null,null,null,updatePercent,!0);file2saveContent='{\n    "config": '+data+"\n}"}self.postMessage({admin:"saveListener: removeEventListener saveListener"}),self.removeEventListener("message",dm_AggregationWorker_workerListener,!1),self.postMessage({percent:100,file2saveContent:file2saveContent});break;default:self.postMessage({admin:"listener: Unknown command: "+data.cmd})}},dm_AggregationWorker_workerAdminListener=function(a){var b=a.data;switch(b.cmd){case"start":self.postMessage({admin:"adminListener: WORKER STARTED"}),b.imports.forEach(function(a){self.postMessage({admin:"adminListener: WORKER IMPORT : "+a}),importScripts(a)});break;case"addListener":self.postMessage({admin:"adminListener: addEventListener"}),self.addEventListener("message",dm_AggregationWorker_workerListener);break;case"stop":self.postMessage({admin:"adminListener: WORKER STOPPED: "+b.msg}),self.close();break;default:self.postMessage({admin:"adminListener: Unknown command: "+b.cmd})}},self.addEventListener("message",dm_AggregationWorker_workerAdminListener);